[0m11:16:48.771885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10962b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10962b9d0>]}


============================== 11:16:48.774866 | 0475f59e-b43c-4076-84f3-dd2f30a00a4b ==============================
[0m11:16:48.774866 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:16:48.775174 [debug] [MainThread]: running dbt with arguments {'log_path': 'logs', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/barbaramariano/.dbt', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'printer_width': '80', 'log_format': 'default', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None'}
[0m11:16:48.789375 [info ] [MainThread]: dbt version: 1.10.13
[0m11:16:48.789584 [info ] [MainThread]: python version: 3.13.7
[0m11:16:48.789710 [info ] [MainThread]: python path: /Users/barbaramariano/repositories/funnel_analysis/.venv/bin/python3.13
[0m11:16:48.789833 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit-Mach-O
[0m11:16:48.789953 [info ] [MainThread]: Using profiles dir at /Users/barbaramariano/.dbt
[0m11:16:48.790060 [info ] [MainThread]: Using profiles.yml file at /Users/barbaramariano/.dbt/profiles.yml
[0m11:16:48.790165 [info ] [MainThread]: Using dbt_project.yml file at /Users/barbaramariano/repositories/funnel_analysis/dbt_project.yml
[0m11:16:48.790277 [info ] [MainThread]: Configuration:
[0m11:16:48.790377 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m11:16:48.790478 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m11:16:48.790579 [info ] [MainThread]: Required dependencies:
[0m11:16:48.790713 [debug] [MainThread]: Executing "git --help"
[0m11:16:48.816741 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:16:48.817376 [debug] [MainThread]: STDERR: "b''"
[0m11:16:48.817598 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:16:48.817774 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:16:48.817991 [info ] [MainThread]: [31m2 checks failed:[0m
[0m11:16:48.818124 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/barbaramariano/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m11:16:48.818250 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/barbaramariano/repositories/funnel_analysis/dbt_project.yml> not found

[0m11:16:48.831903 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.09492396, "process_in_blocks": "0", "process_kernel_time": 0.137917, "process_mem_max_rss": "104005632", "process_out_blocks": "0", "process_user_time": 0.755458}
[0m11:16:48.832305 [debug] [MainThread]: Command `dbt debug` failed at 11:16:48.832240 after 0.10 seconds
[0m11:16:48.832620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109718510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10952b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094cb350>]}
[0m11:16:48.832852 [debug] [MainThread]: Flushing usage events
[0m11:16:49.312213 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:59.627619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d141a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5f9d0>]}


============================== 11:18:59.630828 | 3624fa9a-a605-4d43-a78e-7a0cf5653994 ==============================
[0m11:18:59.630828 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:18:59.631164 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'log_format': 'default', 'printer_width': '80', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'empty': 'None', 'debug': 'False', 'profiles_dir': '/Users/barbaramariano/.dbt', 'log_cache_events': 'False', 'introspect': 'True'}
[0m11:18:59.645719 [info ] [MainThread]: dbt version: 1.10.13
[0m11:18:59.645938 [info ] [MainThread]: python version: 3.13.7
[0m11:18:59.646069 [info ] [MainThread]: python path: /Users/barbaramariano/repositories/funnel_analysis/.venv/bin/python3.13
[0m11:18:59.646186 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit-Mach-O
[0m11:18:59.646307 [info ] [MainThread]: Using profiles dir at /Users/barbaramariano/.dbt
[0m11:18:59.646419 [info ] [MainThread]: Using profiles.yml file at /Users/barbaramariano/.dbt/profiles.yml
[0m11:18:59.646542 [info ] [MainThread]: Using dbt_project.yml file at /Users/barbaramariano/repositories/funnel_analysis/dbt_project.yml
[0m11:18:59.691700 [info ] [MainThread]: Configuration:
[0m11:18:59.691929 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m11:18:59.692072 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:18:59.692192 [info ] [MainThread]: Required dependencies:
[0m11:18:59.692364 [debug] [MainThread]: Executing "git --help"
[0m11:18:59.703362 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:18:59.703893 [debug] [MainThread]: STDERR: "b''"
[0m11:18:59.704066 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:18:59.704214 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:18:59.704344 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:18:59.704460 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/barbaramariano/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m11:18:59.706437 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.12006175, "process_in_blocks": "0", "process_kernel_time": 0.11895, "process_mem_max_rss": "106496000", "process_out_blocks": "0", "process_user_time": 0.652735}
[0m11:18:59.706743 [debug] [MainThread]: Command `dbt debug` failed at 11:18:59.706691 after 0.12 seconds
[0m11:18:59.706983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11891b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de6e00>]}
[0m11:18:59.707196 [debug] [MainThread]: Flushing usage events
[0m11:19:00.153929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:24:18.304007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702b9d0>]}


============================== 11:24:18.307131 | 1d1da481-4ab2-4db6-aef7-71a3c9e024ad ==============================
[0m11:24:18.307131 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:24:18.307484 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/barbaramariano/.dbt', 'log_cache_events': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'version_check': 'True', 'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'use_colors': 'True', 'introspect': 'True'}
[0m11:24:18.322375 [info ] [MainThread]: dbt version: 1.10.13
[0m11:24:18.322618 [info ] [MainThread]: python version: 3.13.7
[0m11:24:18.322757 [info ] [MainThread]: python path: /Users/barbaramariano/repositories/funnel_analysis/.venv/bin/python3.13
[0m11:24:18.322882 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit-Mach-O
[0m11:24:34.029975 [info ] [MainThread]: Using profiles dir at /Users/barbaramariano/.dbt
[0m11:24:34.030455 [info ] [MainThread]: Using profiles.yml file at /Users/barbaramariano/.dbt/profiles.yml
[0m11:24:34.030599 [info ] [MainThread]: Using dbt_project.yml file at /Users/barbaramariano/repositories/funnel_analysis/dbt_project.yml
[0m11:24:34.030724 [info ] [MainThread]: adapter type: bigquery
[0m11:24:34.030868 [info ] [MainThread]: adapter version: 1.10.2
[0m11:24:34.079733 [info ] [MainThread]: Configuration:
[0m11:24:34.080019 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:24:34.080167 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:24:34.080293 [info ] [MainThread]: Required dependencies:
[0m11:24:34.080482 [debug] [MainThread]: Executing "git --help"
[0m11:24:34.106616 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:24:34.107176 [debug] [MainThread]: STDERR: "b''"
[0m11:24:34.107351 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:24:34.107508 [info ] [MainThread]: Connection:
[0m11:24:34.107674 [info ] [MainThread]:   method: oauth
[0m11:24:34.107794 [info ] [MainThread]:   database: funnel-analysis-473408
[0m11:24:34.107914 [info ] [MainThread]:   execution_project: funnel-analysis-473408
[0m11:24:34.108019 [info ] [MainThread]:   schema: analytics
[0m11:24:34.108116 [info ] [MainThread]:   location: EU
[0m11:24:34.108215 [info ] [MainThread]:   priority: interactive
[0m11:24:34.108319 [info ] [MainThread]:   maximum_bytes_billed: None
[0m11:24:34.108419 [info ] [MainThread]:   impersonate_service_account: None
[0m11:24:34.108518 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m11:24:34.108618 [info ] [MainThread]:   job_retries: 1
[0m11:24:34.108715 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m11:24:34.108811 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m11:24:34.108909 [info ] [MainThread]:   timeout_seconds: None
[0m11:24:34.109007 [info ] [MainThread]:   client_id: None
[0m11:24:34.109101 [info ] [MainThread]:   token_uri: None
[0m11:24:34.109198 [info ] [MainThread]:   compute_region: None
[0m11:24:34.109292 [info ] [MainThread]:   dataproc_cluster_name: None
[0m11:24:34.109388 [info ] [MainThread]:   gcs_bucket: None
[0m11:24:34.109484 [info ] [MainThread]:   dataproc_batch: None
[0m11:24:34.109828 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:24:34.296863 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m11:24:34.297346 [debug] [MainThread]: On debug: select 1 as id
[0m11:24:34.297542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:24:43.379312 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: 'Runtime Error
  Failed to authenticate with supplied credentials
  error:
  Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.'
[0m11:24:43.381982 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
select 1 as id
[0m11:24:43.383045 [debug] [MainThread]: BigQuery adapter: Database Error
  Runtime Error
    Failed to authenticate with supplied credentials
    error:
    Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
[0m11:24:43.384436 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:24:43.385248 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:24:43.385626 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >'NoneType' object has no attribute 'close'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:24:43.391974 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 25.121424, "process_in_blocks": "0", "process_kernel_time": 0.681106, "process_mem_max_rss": "338903040", "process_out_blocks": "0", "process_user_time": 3.183402}
[0m11:24:43.394999 [debug] [MainThread]: Command `dbt debug` failed at 11:24:43.394758 after 25.13 seconds
[0m11:24:43.396178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168026520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16808e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1466b8d10>]}
[0m11:24:43.396867 [debug] [MainThread]: Flushing usage events
[0m11:24:43.893499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:30:21.941956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dc1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5f9d0>]}


============================== 11:30:21.945814 | 685da97c-8971-47b7-9984-64adbcdf5803 ==============================
[0m11:30:21.945814 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:30:21.946133 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_format': 'default', 'empty': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'no_print': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/barbaramariano/.dbt', 'introspect': 'True', 'invocation_command': 'dbt debug'}
[0m11:30:21.959726 [info ] [MainThread]: dbt version: 1.10.13
[0m11:30:21.959943 [info ] [MainThread]: python version: 3.13.7
[0m11:30:21.960074 [info ] [MainThread]: python path: /Users/barbaramariano/repositories/funnel_analysis/.venv/bin/python3.13
[0m11:30:21.960193 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit-Mach-O
[0m11:30:23.589475 [info ] [MainThread]: Using profiles dir at /Users/barbaramariano/.dbt
[0m11:30:23.589758 [info ] [MainThread]: Using profiles.yml file at /Users/barbaramariano/.dbt/profiles.yml
[0m11:30:23.589934 [info ] [MainThread]: Using dbt_project.yml file at /Users/barbaramariano/repositories/funnel_analysis/dbt_project.yml
[0m11:30:23.590109 [info ] [MainThread]: adapter type: bigquery
[0m11:30:23.590238 [info ] [MainThread]: adapter version: 1.10.2
[0m11:30:23.644166 [info ] [MainThread]: Configuration:
[0m11:30:23.644642 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:30:23.644827 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:30:23.644964 [info ] [MainThread]: Required dependencies:
[0m11:30:23.645166 [debug] [MainThread]: Executing "git --help"
[0m11:30:23.671635 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:30:23.672181 [debug] [MainThread]: STDERR: "b''"
[0m11:30:23.672360 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:30:23.672520 [info ] [MainThread]: Connection:
[0m11:30:23.672706 [info ] [MainThread]:   method: oauth
[0m11:30:23.672830 [info ] [MainThread]:   database: funnel-analysis-473408
[0m11:30:23.672952 [info ] [MainThread]:   execution_project: funnel-analysis-473408
[0m11:30:23.673066 [info ] [MainThread]:   schema: analytics
[0m11:30:23.673176 [info ] [MainThread]:   location: europe-west9
[0m11:30:23.673287 [info ] [MainThread]:   priority: interactive
[0m11:30:23.673396 [info ] [MainThread]:   maximum_bytes_billed: None
[0m11:30:23.673502 [info ] [MainThread]:   impersonate_service_account: None
[0m11:30:23.673612 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m11:30:23.673716 [info ] [MainThread]:   job_retries: 1
[0m11:30:23.673823 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m11:30:23.673929 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m11:30:23.674033 [info ] [MainThread]:   timeout_seconds: None
[0m11:30:23.674143 [info ] [MainThread]:   client_id: None
[0m11:30:23.674246 [info ] [MainThread]:   token_uri: None
[0m11:30:23.674351 [info ] [MainThread]:   compute_region: None
[0m11:30:23.674457 [info ] [MainThread]:   dataproc_cluster_name: None
[0m11:30:23.674561 [info ] [MainThread]:   gcs_bucket: None
[0m11:30:23.674667 [info ] [MainThread]:   dataproc_batch: None
[0m11:30:23.674989 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:30:23.834933 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m11:30:23.835254 [debug] [MainThread]: On debug: select 1 as id
[0m11:30:23.835410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:30:32.657169 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: 'Runtime Error
  Failed to authenticate with supplied credentials
  error:
  Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.'
[0m11:30:32.660111 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
select 1 as id
[0m11:30:32.660693 [debug] [MainThread]: BigQuery adapter: Database Error
  Runtime Error
    Failed to authenticate with supplied credentials
    error:
    Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
[0m11:30:32.662084 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:30:32.662997 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:30:32.663429 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >'NoneType' object has no attribute 'close'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:30:32.671010 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 10.767146, "process_in_blocks": "0", "process_kernel_time": 0.588169, "process_mem_max_rss": "348405760", "process_out_blocks": "0", "process_user_time": 3.12048}
[0m11:30:32.674950 [debug] [MainThread]: Command `dbt debug` failed at 11:30:32.674604 after 10.77 seconds
[0m11:30:32.676421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160326190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16038e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16046cc00>]}
[0m11:30:32.677263 [debug] [MainThread]: Flushing usage events
[0m11:30:33.188061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:30:34.581496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d901a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdf9d0>]}


============================== 11:30:34.584166 | a2a159ea-0bbf-40f6-a98f-46cc07511d2d ==============================
[0m11:30:34.584166 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:30:34.584467 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/barbaramariano/.dbt', 'fail_fast': 'False', 'partial_parse': 'True', 'no_print': 'None', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'invocation_command': 'dbt seed', 'printer_width': '80', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'target_path': 'None'}
[0m11:30:36.031844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2a159ea-0bbf-40f6-a98f-46cc07511d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed3bb0>]}
[0m11:30:36.057978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2a159ea-0bbf-40f6-a98f-46cc07511d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169c6d370>]}
[0m11:30:36.058275 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:30:36.238142 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:30:36.238597 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:30:36.238785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a2a159ea-0bbf-40f6-a98f-46cc07511d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1699e7850>]}
[0m11:30:36.577581 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.funnel_analysis.marts
- models.funnel_analysis
[0m11:30:36.579797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2a159ea-0bbf-40f6-a98f-46cc07511d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076cbc50>]}
[0m11:30:36.598764 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m11:30:36.599973 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m11:30:36.641225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2a159ea-0bbf-40f6-a98f-46cc07511d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a196190>]}
[0m11:30:36.641502 [info ] [MainThread]: Found 495 macros
[0m11:30:36.641661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2a159ea-0bbf-40f6-a98f-46cc07511d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a1efba0>]}
[0m11:30:36.642317 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:30:36.642580 [debug] [MainThread]: Command end result
[0m11:30:36.653117 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m11:30:36.653984 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m11:30:36.655601 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m11:30:36.655752 [info ] [MainThread]: 
[0m11:30:36.655941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:30:36.656062 [info ] [MainThread]: 
[0m11:30:36.656195 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m11:30:36.657484 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.1076741, "process_in_blocks": "0", "process_kernel_time": 0.50283, "process_mem_max_rss": "343277568", "process_out_blocks": "0", "process_user_time": 3.457809}
[0m11:30:36.657789 [debug] [MainThread]: Command `dbt seed` succeeded at 11:30:36.657743 after 2.11 seconds
[0m11:30:36.657987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a1de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a1b31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a1b2fc0>]}
[0m11:30:36.658143 [debug] [MainThread]: Flushing usage events
[0m11:30:37.046762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:30:38.387818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079101a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111367890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113679d0>]}


============================== 11:30:38.390522 | c58aa7f0-2931-43d3-83aa-0ac68937b79e ==============================
[0m11:30:38.390522 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:30:38.390824 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'log_cache_events': 'False', 'profiles_dir': '/Users/barbaramariano/.dbt', 'warn_error': 'None', 'debug': 'False', 'empty': 'False', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'partial_parse': 'True', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'write_json': 'True', 'static_parser': 'True'}
[0m11:30:39.711225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c58aa7f0-2931-43d3-83aa-0ac68937b79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a57bb0>]}
[0m11:30:39.737625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c58aa7f0-2931-43d3-83aa-0ac68937b79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x171765370>]}
[0m11:30:39.737910 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:30:39.901217 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:30:39.936107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:30:39.936295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:30:39.936576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.funnel_analysis
- models.funnel_analysis.marts
[0m11:30:39.939009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c58aa7f0-2931-43d3-83aa-0ac68937b79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d07ae50>]}
[0m11:30:39.960642 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m11:30:39.961706 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m11:30:39.972831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c58aa7f0-2931-43d3-83aa-0ac68937b79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1717c0d70>]}
[0m11:30:39.973097 [info ] [MainThread]: Found 495 macros
[0m11:30:39.973256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c58aa7f0-2931-43d3-83aa-0ac68937b79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x171c260b0>]}
[0m11:30:39.973937 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:30:39.974888 [debug] [MainThread]: Command end result
[0m11:30:39.986001 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m11:30:39.987454 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m11:30:39.989547 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m11:30:39.991029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6348288, "process_in_blocks": "0", "process_kernel_time": 0.770342, "process_mem_max_rss": "334331904", "process_out_blocks": "0", "process_user_time": 2.984597}
[0m11:30:39.991394 [debug] [MainThread]: Command `dbt run` succeeded at 11:30:39.991335 after 1.64 seconds
[0m11:30:39.991593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x171c5bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d091490>]}
[0m11:30:39.991761 [debug] [MainThread]: Flushing usage events
[0m11:30:40.375024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:13.226517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061881a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd79d0>]}


============================== 11:40:13.229860 | d4b2b62f-2426-44bf-aa43-ff10aeabf134 ==============================
[0m11:40:13.229860 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:40:13.230303 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt seed', 'printer_width': '80', 'log_format': 'default', 'empty': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'target_path': 'None', 'use_colors': 'True', 'debug': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'profiles_dir': '/Users/barbaramariano/.dbt', 'fail_fast': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs'}
[0m11:40:14.969371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4b2b62f-2426-44bf-aa43-ff10aeabf134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cbbb0>]}
[0m11:40:14.995435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4b2b62f-2426-44bf-aa43-ff10aeabf134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fe65370>]}
[0m11:40:14.995743 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:40:15.162706 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:40:15.200574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:40:15.200813 [debug] [MainThread]: Partial parsing: added file: funnel_analysis://seeds/events.csv
[0m11:40:15.291398 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.funnel_analysis
- models.funnel_analysis.marts
[0m11:40:15.293742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4b2b62f-2426-44bf-aa43-ff10aeabf134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fde7750>]}
[0m11:40:15.320431 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m11:40:15.322143 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m11:40:15.332915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4b2b62f-2426-44bf-aa43-ff10aeabf134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1603e9d60>]}
[0m11:40:15.333147 [info ] [MainThread]: Found 1 seed, 495 macros
[0m11:40:15.333307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4b2b62f-2426-44bf-aa43-ff10aeabf134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160167cb0>]}
[0m11:40:15.334365 [info ] [MainThread]: 
[0m11:40:15.334536 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m11:40:15.334658 [info ] [MainThread]: 
[0m11:40:15.334887 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:40:15.335280 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m11:40:15.335462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:21.245144 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: 'Runtime Error
  Failed to authenticate with supplied credentials
  error:
  Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.'
[0m11:40:21.249585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:40:24.312565 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: 'Runtime Error
  Failed to authenticate with supplied credentials
  error:
  Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.'
[0m11:40:24.314690 [info ] [MainThread]: 
[0m11:40:24.315666 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 8.98 seconds (8.98s).
[0m11:40:24.318019 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    Failed to authenticate with supplied credentials
    error:
    Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
[0m11:40:24.326917 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 11.135815, "process_in_blocks": "0", "process_kernel_time": 0.65527, "process_mem_max_rss": "352763904", "process_out_blocks": "0", "process_user_time": 3.240623}
[0m11:40:24.330835 [debug] [MainThread]: Command `dbt seed` failed at 11:40:24.330315 after 11.14 seconds
[0m11:40:24.332306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16064c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e19e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16062b950>]}
[0m11:40:24.333406 [debug] [MainThread]: Flushing usage events
[0m11:40:24.820584 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:40.259998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064141a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f67890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f679d0>]}


============================== 12:00:40.263077 | 690d303f-8805-4af5-a6a9-a783c6cf1f6e ==============================
[0m12:00:40.263077 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:00:40.263394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'None', 'invocation_command': 'dbt seed', 'debug': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'no_print': 'None', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'log_format': 'default', 'profiles_dir': '/Users/barbaramariano/.dbt', 'target_path': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_colors': 'True'}
[0m12:00:41.983740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '690d303f-8805-4af5-a6a9-a783c6cf1f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106657bb0>]}
[0m12:00:42.010582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '690d303f-8805-4af5-a6a9-a783c6cf1f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15df65370>]}
[0m12:00:42.010920 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:00:42.199352 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:00:42.251197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:42.251507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:42.254552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.funnel_analysis
- models.funnel_analysis.marts
[0m12:00:42.263555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '690d303f-8805-4af5-a6a9-a783c6cf1f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dee7150>]}
[0m12:00:42.292672 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m12:00:42.294279 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m12:00:42.306602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '690d303f-8805-4af5-a6a9-a783c6cf1f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e4e5a90>]}
[0m12:00:42.306842 [info ] [MainThread]: Found 1 seed, 495 macros
[0m12:00:42.306997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '690d303f-8805-4af5-a6a9-a783c6cf1f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e61eb30>]}
[0m12:00:42.307762 [info ] [MainThread]: 
[0m12:00:42.307938 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m12:00:42.308055 [info ] [MainThread]: 
[0m12:00:42.308277 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:00:42.308695 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m12:00:42.308898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:43.153721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m12:00:43.154969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:43.329486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '690d303f-8805-4af5-a6a9-a783c6cf1f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e63ce20>]}
[0m12:00:43.330583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:43.338500 [debug] [Thread-1 (]: Began running node seed.funnel_analysis.events
[0m12:00:43.339569 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.events ........................................ [RUN]
[0m12:00:43.340350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now seed.funnel_analysis.events)
[0m12:00:43.340849 [debug] [Thread-1 (]: Began compiling node seed.funnel_analysis.events
[0m12:00:43.341210 [debug] [Thread-1 (]: Began executing node seed.funnel_analysis.events
[0m12:00:43.410953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:45.052017 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:10:00Z"; line_number: 2 byte_offset_to_start_of_line: 50 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:15:00Z"; line_number: 3 byte_offset_to_start_of_line: 89 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:15:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T09:00:00Z"; line_number: 4 byte_offset_to_start_of_line: 139 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T09:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-21T10:20:00Z"; line_number: 5 byte_offset_to_start_of_line: 182 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-21T10:20:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:12:00Z"; line_number: 6 byte_offset_to_start_of_line: 228 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:12:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:16:00Z"; line_number: 7 byte_offset_to_start_of_line: 271 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:16:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T11:00:00Z"; line_number: 8 byte_offset_to_start_of_line: 325 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T11:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T12:10:00Z"; line_number: 9 byte_offset_to_start_of_line: 368 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T12:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T14:20:00Z"; line_number: 10 byte_offset_to_start_of_line: 422 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T14:20:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m12:00:45.064899 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/base.py", line 363, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/base.py", line 310, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/base.py", line 410, in run
    return self.execute(compiled_node, manifest)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/run.py", line 336, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/run.py", line 296, in _execute_model
    result = MacroGenerator(
        materialization_macro, context, stack=context["context_macro_stack"]
    )()
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 109, in macro
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/adapters/bigquery/impl.py", line 683, in load_dataframe
    self.connections.write_dataframe_to_table(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        client,
        ^^^^^^^
    ...<6 lines>...
        fallback_timeout=300,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/adapters/bigquery/connections.py", line 486, in write_dataframe_to_table
    self._write_file_to_table(client, file_path, table, load_config, fallback_timeout)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/adapters/bigquery/connections.py", line 518, in _write_file_to_table
    response = job.result(retry=self._retry.create_retry(fallback=fallback_timeout))
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:10:00Z"; line_number: 2 byte_offset_to_start_of_line: 50 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:15:00Z"; line_number: 3 byte_offset_to_start_of_line: 89 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:15:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T09:00:00Z"; line_number: 4 byte_offset_to_start_of_line: 139 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T09:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-21T10:20:00Z"; line_number: 5 byte_offset_to_start_of_line: 182 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-21T10:20:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:12:00Z"; line_number: 6 byte_offset_to_start_of_line: 228 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:12:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:16:00Z"; line_number: 7 byte_offset_to_start_of_line: 271 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:16:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T11:00:00Z"; line_number: 8 byte_offset_to_start_of_line: 325 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T11:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T12:10:00Z"; line_number: 9 byte_offset_to_start_of_line: 368 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T12:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T14:20:00Z"; line_number: 10 byte_offset_to_start_of_line: 422 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T14:20:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.

[0m12:00:45.068724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '690d303f-8805-4af5-a6a9-a783c6cf1f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f270650>]}
[0m12:00:45.069446 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file analytics.events ................................ [[31mERROR[0m in 1.73s]
[0m12:00:45.070460 [debug] [Thread-1 (]: Finished running node seed.funnel_analysis.events
[0m12:00:45.071587 [debug] [Thread-7 (]: Marking all children of 'seed.funnel_analysis.events' to be skipped because of status 'error'.  Reason: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:10:00Z"; line_number: 2 byte_offset_to_start_of_line: 50 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:15:00Z"; line_number: 3 byte_offset_to_start_of_line: 89 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:15:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T09:00:00Z"; line_number: 4 byte_offset_to_start_of_line: 139 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T09:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-21T10:20:00Z"; line_number: 5 byte_offset_to_start_of_line: 182 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-21T10:20:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:12:00Z"; line_number: 6 byte_offset_to_start_of_line: 228 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:12:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:16:00Z"; line_number: 7 byte_offset_to_start_of_line: 271 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:16:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T11:00:00Z"; line_number: 8 byte_offset_to_start_of_line: 325 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T11:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T12:10:00Z"; line_number: 9 byte_offset_to_start_of_line: 368 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T12:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T14:20:00Z"; line_number: 10 byte_offset_to_start_of_line: 422 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T14:20:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format..
[0m12:00:45.075148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:00:45.075854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:45.076388 [debug] [MainThread]: Connection 'seed.funnel_analysis.events' was properly closed.
[0m12:00:45.076843 [info ] [MainThread]: 
[0m12:00:45.077305 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m12:00:45.078073 [debug] [MainThread]: Command end result
[0m12:00:45.106975 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m12:00:45.108778 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m12:00:45.113777 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m12:00:45.114000 [info ] [MainThread]: 
[0m12:00:45.114268 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:00:45.114463 [info ] [MainThread]: 
[0m12:00:45.114676 [error] [MainThread]: [31mFailure in seed events (seeds/events.csv)[0m
[0m12:00:45.114968 [error] [MainThread]:   400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:10:00Z"; line_number: 2 byte_offset_to_start_of_line: 50 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:15:00Z"; line_number: 3 byte_offset_to_start_of_line: 89 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:15:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T09:00:00Z"; line_number: 4 byte_offset_to_start_of_line: 139 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T09:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-21T10:20:00Z"; line_number: 5 byte_offset_to_start_of_line: 182 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-21T10:20:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:12:00Z"; line_number: 6 byte_offset_to_start_of_line: 228 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:12:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:16:00Z"; line_number: 7 byte_offset_to_start_of_line: 271 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:16:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T11:00:00Z"; line_number: 8 byte_offset_to_start_of_line: 325 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T11:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T12:10:00Z"; line_number: 9 byte_offset_to_start_of_line: 368 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T12:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T14:20:00Z"; line_number: 10 byte_offset_to_start_of_line: 422 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T14:20:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m12:00:45.116235 [info ] [MainThread]: 
[0m12:00:45.116666 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:00:45.147644 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.9286947, "process_in_blocks": "0", "process_kernel_time": 0.826451, "process_mem_max_rss": "338935808", "process_out_blocks": "0", "process_user_time": 3.250848}
[0m12:00:45.148115 [debug] [MainThread]: Command `dbt seed` failed at 12:00:45.148048 after 4.93 seconds
[0m12:00:45.148425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e622fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e69cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e69d130>]}
[0m12:00:45.148633 [debug] [MainThread]: Flushing usage events
[0m12:00:45.583338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:32.138042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112141a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c67890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c679d0>]}


============================== 16:48:32.142453 | b2755f63-e12b-49a2-abfe-f3d687500372 ==============================
[0m16:48:32.142453 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:48:32.142789 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'target_path': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/barbaramariano/.dbt', 'invocation_command': 'dbt ls', 'warn_error': 'None', 'log_format': 'default', 'write_json': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'printer_width': '80', 'use_colors': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'no_print': 'None', 'fail_fast': 'False'}
[0m16:48:34.973250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2755f63-e12b-49a2-abfe-f3d687500372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111357bb0>]}
[0m16:48:34.999248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2755f63-e12b-49a2-abfe-f3d687500372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169d65370>]}
[0m16:48:34.999549 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:48:35.183092 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:48:35.231559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 7 files added, 0 files changed.
[0m16:48:35.231813 [debug] [MainThread]: Partial parsing: added file: funnel_analysis://models/marts/fct_funnel_conversions.sql
[0m16:48:35.231956 [debug] [MainThread]: Partial parsing: added file: funnel_analysis://models/marts/fct_funnel_by_cohort.sql
[0m16:48:35.232110 [debug] [MainThread]: Partial parsing: added file: funnel_analysis://models/schema.yml
[0m16:48:35.232229 [debug] [MainThread]: Partial parsing: added file: funnel_analysis://models/intermediate/int_user_first_step_ts.sql
[0m16:48:35.232346 [debug] [MainThread]: Partial parsing: added file: funnel_analysis://models/staging/stg_events.sql
[0m16:48:35.232499 [debug] [MainThread]: Partial parsing: added file: funnel_analysis://models/marts/fct_funnel_by_source.sql
[0m16:48:35.232692 [debug] [MainThread]: Partial parsing: added file: funnel_analysis://models/intermediate/int_user_funnel_path.sql
[0m16:48:35.400431 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m16:48:35.400724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b2755f63-e12b-49a2-abfe-f3d687500372', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a377250>]}
[0m16:48:35.445641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2755f63-e12b-49a2-abfe-f3d687500372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b6b3890>]}
[0m16:48:35.487123 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m16:48:35.489593 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m16:48:35.500640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2755f63-e12b-49a2-abfe-f3d687500372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169f1e270>]}
[0m16:48:35.500864 [info ] [MainThread]: Found 1 seed, 6 models, 5 data tests, 495 macros
[0m16:48:35.501022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2755f63-e12b-49a2-abfe-f3d687500372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bf37c70>]}
[0m16:48:35.501451 [info ] [MainThread]: funnel_analysis.marts.fct_funnel_by_cohort
[0m16:48:35.501600 [info ] [MainThread]: funnel_analysis.marts.fct_funnel_by_source
[0m16:48:35.501708 [info ] [MainThread]: funnel_analysis.marts.fct_funnel_conversions
[0m16:48:35.501819 [info ] [MainThread]: funnel_analysis.intermediate.int_user_first_step_ts
[0m16:48:35.501922 [info ] [MainThread]: funnel_analysis.intermediate.int_user_funnel_path
[0m16:48:35.502028 [info ] [MainThread]: funnel_analysis.staging.stg_events
[0m16:48:35.502127 [info ] [MainThread]: funnel_analysis.events
[0m16:48:35.502228 [info ] [MainThread]: funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment
[0m16:48:35.502332 [info ] [MainThread]: funnel_analysis.not_null_int_user_funnel_path_user_id
[0m16:48:35.502431 [info ] [MainThread]: funnel_analysis.not_null_stg_events_event_ts
[0m16:48:35.502533 [info ] [MainThread]: funnel_analysis.not_null_stg_events_user_id
[0m16:48:35.502630 [info ] [MainThread]: funnel_analysis.unique_int_user_funnel_path_user_id
[0m16:48:35.502839 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:48:35.515968 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 3.4259171, "process_in_blocks": "0", "process_kernel_time": 0.6126, "process_mem_max_rss": "354631680", "process_out_blocks": "0", "process_user_time": 3.329553}
[0m16:48:35.516361 [debug] [MainThread]: Command `dbt ls` succeeded at 16:48:35.516303 after 3.43 seconds
[0m16:48:35.516557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aa5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b745650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b745700>]}
[0m16:48:35.516761 [debug] [MainThread]: Flushing usage events
[0m16:48:35.968292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:27.874859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d181a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121767890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217679d0>]}


============================== 16:49:27.878002 | 41c69a5a-2626-49de-b535-095863d599ec ==============================
[0m16:49:27.878002 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:49:27.878340 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'introspect': 'True', 'profiles_dir': '/Users/barbaramariano/.dbt', 'static_parser': 'True', 'quiet': 'False', 'log_format': 'default', 'write_json': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'no_print': 'None', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'invocation_command': 'dbt seed', 'log_cache_events': 'False'}
[0m16:49:29.616124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41c69a5a-2626-49de-b535-095863d599ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e5bbb0>]}
[0m16:49:29.642332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41c69a5a-2626-49de-b535-095863d599ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157f6d370>]}
[0m16:49:29.642645 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:49:29.812810 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:49:29.880722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:29.880923 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:29.901632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41c69a5a-2626-49de-b535-095863d599ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158476850>]}
[0m16:49:29.939288 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m16:49:29.941302 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m16:49:29.954680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41c69a5a-2626-49de-b535-095863d599ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1584f5d60>]}
[0m16:49:29.954903 [info ] [MainThread]: Found 1 seed, 6 models, 5 data tests, 495 macros
[0m16:49:29.955063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41c69a5a-2626-49de-b535-095863d599ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15801e970>]}
[0m16:49:29.955869 [info ] [MainThread]: 
[0m16:49:29.956034 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m16:49:29.956154 [info ] [MainThread]: 
[0m16:49:29.956368 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:49:29.956743 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m16:49:29.956906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:31.639288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m16:49:31.640688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:31.812952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41c69a5a-2626-49de-b535-095863d599ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1586507a0>]}
[0m16:49:31.814570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:31.822244 [debug] [Thread-1 (]: Began running node seed.funnel_analysis.events
[0m16:49:31.823248 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.events ........................................ [RUN]
[0m16:49:31.823932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now seed.funnel_analysis.events)
[0m16:49:31.824411 [debug] [Thread-1 (]: Began compiling node seed.funnel_analysis.events
[0m16:49:31.824864 [debug] [Thread-1 (]: Began executing node seed.funnel_analysis.events
[0m16:49:31.893169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:33.559769 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:10:00Z"; line_number: 2 byte_offset_to_start_of_line: 50 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:15:00Z"; line_number: 3 byte_offset_to_start_of_line: 89 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:15:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T09:00:00Z"; line_number: 4 byte_offset_to_start_of_line: 139 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T09:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-21T10:20:00Z"; line_number: 5 byte_offset_to_start_of_line: 182 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-21T10:20:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:12:00Z"; line_number: 6 byte_offset_to_start_of_line: 228 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:12:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:16:00Z"; line_number: 7 byte_offset_to_start_of_line: 271 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:16:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T11:00:00Z"; line_number: 8 byte_offset_to_start_of_line: 325 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T11:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T12:10:00Z"; line_number: 9 byte_offset_to_start_of_line: 368 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T12:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T14:20:00Z"; line_number: 10 byte_offset_to_start_of_line: 422 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T14:20:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:49:33.576534 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/base.py", line 363, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/base.py", line 310, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/base.py", line 410, in run
    return self.execute(compiled_node, manifest)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/run.py", line 336, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/run.py", line 296, in _execute_model
    result = MacroGenerator(
        materialization_macro, context, stack=context["context_macro_stack"]
    )()
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 109, in macro
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/adapters/bigquery/impl.py", line 683, in load_dataframe
    self.connections.write_dataframe_to_table(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        client,
        ^^^^^^^
    ...<6 lines>...
        fallback_timeout=300,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/adapters/bigquery/connections.py", line 486, in write_dataframe_to_table
    self._write_file_to_table(client, file_path, table, load_config, fallback_timeout)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/adapters/bigquery/connections.py", line 518, in _write_file_to_table
    response = job.result(retry=self._retry.create_retry(fallback=fallback_timeout))
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:10:00Z"; line_number: 2 byte_offset_to_start_of_line: 50 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:15:00Z"; line_number: 3 byte_offset_to_start_of_line: 89 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:15:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T09:00:00Z"; line_number: 4 byte_offset_to_start_of_line: 139 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T09:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-21T10:20:00Z"; line_number: 5 byte_offset_to_start_of_line: 182 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-21T10:20:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:12:00Z"; line_number: 6 byte_offset_to_start_of_line: 228 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:12:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:16:00Z"; line_number: 7 byte_offset_to_start_of_line: 271 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:16:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T11:00:00Z"; line_number: 8 byte_offset_to_start_of_line: 325 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T11:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T12:10:00Z"; line_number: 9 byte_offset_to_start_of_line: 368 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T12:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T14:20:00Z"; line_number: 10 byte_offset_to_start_of_line: 422 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T14:20:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.

[0m16:49:33.579668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41c69a5a-2626-49de-b535-095863d599ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1589d9850>]}
[0m16:49:33.580538 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file analytics.events ................................ [[31mERROR[0m in 1.75s]
[0m16:49:33.581244 [debug] [Thread-1 (]: Finished running node seed.funnel_analysis.events
[0m16:49:33.581849 [debug] [Thread-7 (]: Marking all children of 'seed.funnel_analysis.events' to be skipped because of status 'error'.  Reason: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:10:00Z"; line_number: 2 byte_offset_to_start_of_line: 50 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:15:00Z"; line_number: 3 byte_offset_to_start_of_line: 89 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:15:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T09:00:00Z"; line_number: 4 byte_offset_to_start_of_line: 139 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T09:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-21T10:20:00Z"; line_number: 5 byte_offset_to_start_of_line: 182 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-21T10:20:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:12:00Z"; line_number: 6 byte_offset_to_start_of_line: 228 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:12:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:16:00Z"; line_number: 7 byte_offset_to_start_of_line: 271 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:16:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T11:00:00Z"; line_number: 8 byte_offset_to_start_of_line: 325 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T11:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T12:10:00Z"; line_number: 9 byte_offset_to_start_of_line: 368 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T12:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T14:20:00Z"; line_number: 10 byte_offset_to_start_of_line: 422 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T14:20:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format..
[0m16:49:33.585337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:33.586312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:33.586579 [debug] [MainThread]: Connection 'seed.funnel_analysis.events' was properly closed.
[0m16:49:33.586832 [info ] [MainThread]: 
[0m16:49:33.587081 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m16:49:33.587705 [debug] [MainThread]: Command end result
[0m16:49:33.606431 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m16:49:33.609320 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m16:49:33.614432 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m16:49:33.614674 [info ] [MainThread]: 
[0m16:49:33.616209 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:49:33.616486 [info ] [MainThread]: 
[0m16:49:33.616807 [error] [MainThread]: [31mFailure in seed events (seeds/events.csv)[0m
[0m16:49:33.617078 [error] [MainThread]:   400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:10:00Z"; line_number: 2 byte_offset_to_start_of_line: 50 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:15:00Z"; line_number: 3 byte_offset_to_start_of_line: 89 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:15:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T09:00:00Z"; line_number: 4 byte_offset_to_start_of_line: 139 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T09:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-21T10:20:00Z"; line_number: 5 byte_offset_to_start_of_line: 182 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-21T10:20:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:12:00Z"; line_number: 6 byte_offset_to_start_of_line: 228 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:12:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:16:00Z"; line_number: 7 byte_offset_to_start_of_line: 271 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:16:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T11:00:00Z"; line_number: 8 byte_offset_to_start_of_line: 325 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T11:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T12:10:00Z"; line_number: 9 byte_offset_to_start_of_line: 368 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T12:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T14:20:00Z"; line_number: 10 byte_offset_to_start_of_line: 422 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T14:20:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:49:33.617361 [info ] [MainThread]: 
[0m16:49:33.617582 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:49:33.622345 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 5.785183, "process_in_blocks": "0", "process_kernel_time": 0.635649, "process_mem_max_rss": "337854464", "process_out_blocks": "0", "process_user_time": 3.436094}
[0m16:49:33.622882 [debug] [MainThread]: Command `dbt seed` failed at 16:49:33.622819 after 5.79 seconds
[0m16:49:33.623307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1586ee2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1586db2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1586db250>]}
[0m16:49:33.623509 [debug] [MainThread]: Flushing usage events
[0m16:49:34.004961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:06.979215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2b9d0>]}


============================== 16:50:06.982549 | 91514293-24d2-4ab0-bb2b-9e5a2933d54e ==============================
[0m16:50:06.982549 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:50:06.982902 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'printer_width': '80', 'indirect_selection': 'eager', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': '/Users/barbaramariano/.dbt', 'warn_error': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True'}
[0m16:50:08.763268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91514293-24d2-4ab0-bb2b-9e5a2933d54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f23bb0>]}
[0m16:50:08.789269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91514293-24d2-4ab0-bb2b-9e5a2933d54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169865370>]}
[0m16:50:08.789559 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:50:08.961698 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:50:09.033584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:09.033904 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:09.056311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91514293-24d2-4ab0-bb2b-9e5a2933d54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169e7a850>]}
[0m16:50:09.093359 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m16:50:09.095275 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m16:50:09.108086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91514293-24d2-4ab0-bb2b-9e5a2933d54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1698c3d40>]}
[0m16:50:09.108310 [info ] [MainThread]: Found 1 seed, 6 models, 5 data tests, 495 macros
[0m16:50:09.108473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91514293-24d2-4ab0-bb2b-9e5a2933d54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169920c90>]}
[0m16:50:09.109349 [info ] [MainThread]: 
[0m16:50:09.109522 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m16:50:09.109646 [info ] [MainThread]: 
[0m16:50:09.109861 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:50:09.111681 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m16:50:09.111871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:09.931697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m16:50:09.932869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:10.057683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91514293-24d2-4ab0-bb2b-9e5a2933d54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b8a07a0>]}
[0m16:50:10.058531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:10.061670 [debug] [Thread-1 (]: Began running node model.funnel_analysis.stg_events
[0m16:50:10.062236 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_events ............................... [RUN]
[0m16:50:10.062732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now model.funnel_analysis.stg_events)
[0m16:50:10.063089 [debug] [Thread-1 (]: Began compiling node model.funnel_analysis.stg_events
[0m16:50:10.077157 [debug] [Thread-1 (]: Writing injected SQL for node "model.funnel_analysis.stg_events"
[0m16:50:10.077973 [debug] [Thread-1 (]: Began executing node model.funnel_analysis.stg_events
[0m16:50:10.098300 [debug] [Thread-1 (]: Writing runtime sql for node "model.funnel_analysis.stg_events"
[0m16:50:10.099145 [debug] [Thread-1 (]: On model.funnel_analysis.stg_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.stg_events"} */


  create or replace view `funnel-analysis-473408`.`analytics`.`stg_events`
  OPTIONS()
  as --clean & standardize the raw seed (analytics.events) so types/text are consistent.



with raw as (
  select
    cast(user_id as int64)                              as user_id,
    timestamp(event_time)                               as event_ts,
    lower(event_name)                                   as event_name,
    cast(step as int64)                                 as step,
    lower(source)                                       as source,
    upper(country)                                      as country
  from `funnel-analysis-473408`.`analytics`.`events`   -- the seeded CSV table
  where lower(event_name) in ('signup','profile_completed','kyc_passed','first_payment')
)
select * from raw;;


[0m16:50:10.099435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:10.238461 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:a67b8240-6cbe-4d09-a6fa-c1009b5a4834&page=queryresults
[0m16:50:10.239222 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:a67b8240-6cbe-4d09-a6fa-c1009b5a4834&page=queryresults
[0m16:50:10.253950 [debug] [Thread-1 (]: Database Error in model stg_events (models/staging/stg_events.sql)
  Syntax error: Unexpected ";" at [21:19]
  compiled code at target/run/funnel_analysis/models/staging/stg_events.sql
[0m16:50:10.255535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91514293-24d2-4ab0-bb2b-9e5a2933d54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ba20290>]}
[0m16:50:10.256080 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model analytics.stg_events ...................... [[31mERROR[0m in 0.19s]
[0m16:50:10.256514 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.stg_events
[0m16:50:10.256923 [debug] [Thread-7 (]: Marking all children of 'model.funnel_analysis.stg_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_events (models/staging/stg_events.sql)
  Syntax error: Unexpected ";" at [21:19]
  compiled code at target/run/funnel_analysis/models/staging/stg_events.sql.
[0m16:50:10.257974 [debug] [Thread-2 (]: Began running node model.funnel_analysis.int_user_first_step_ts
[0m16:50:10.258315 [info ] [Thread-2 (]: 2 of 6 SKIP relation analytics.int_user_first_step_ts .......................... [[33mSKIP[0m]
[0m16:50:10.258619 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.int_user_first_step_ts
[0m16:50:10.259001 [debug] [Thread-3 (]: Began running node model.funnel_analysis.int_user_funnel_path
[0m16:50:10.259325 [info ] [Thread-3 (]: 3 of 6 SKIP relation analytics.int_user_funnel_path ............................ [[33mSKIP[0m]
[0m16:50:10.259682 [debug] [Thread-3 (]: Finished running node model.funnel_analysis.int_user_funnel_path
[0m16:50:10.260154 [debug] [Thread-2 (]: Began running node model.funnel_analysis.fct_funnel_conversions
[0m16:50:10.260740 [debug] [Thread-4 (]: Began running node model.funnel_analysis.fct_funnel_by_cohort
[0m16:50:10.261020 [debug] [Thread-1 (]: Began running node model.funnel_analysis.fct_funnel_by_source
[0m16:50:10.260498 [info ] [Thread-2 (]: 6 of 6 SKIP relation analytics.fct_funnel_conversions .......................... [[33mSKIP[0m]
[0m16:50:10.261615 [info ] [Thread-4 (]: 4 of 6 SKIP relation analytics.fct_funnel_by_cohort ............................ [[33mSKIP[0m]
[0m16:50:10.262254 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.fct_funnel_conversions
[0m16:50:10.262007 [info ] [Thread-1 (]: 5 of 6 SKIP relation analytics.fct_funnel_by_source ............................ [[33mSKIP[0m]
[0m16:50:10.262603 [debug] [Thread-4 (]: Finished running node model.funnel_analysis.fct_funnel_by_cohort
[0m16:50:10.262926 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.fct_funnel_by_source
[0m16:50:10.263656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:10.264019 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:10.264199 [debug] [MainThread]: Connection 'model.funnel_analysis.stg_events' was properly closed.
[0m16:50:10.264437 [info ] [MainThread]: 
[0m16:50:10.264644 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m16:50:10.265177 [debug] [MainThread]: Command end result
[0m16:50:10.282142 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m16:50:10.286971 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m16:50:10.291275 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m16:50:10.291585 [info ] [MainThread]: 
[0m16:50:10.291900 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:50:10.292126 [info ] [MainThread]: 
[0m16:50:10.292347 [error] [MainThread]: [31mFailure in model stg_events (models/staging/stg_events.sql)[0m
[0m16:50:10.292532 [error] [MainThread]:   Database Error in model stg_events (models/staging/stg_events.sql)
  Syntax error: Unexpected ";" at [21:19]
  compiled code at target/run/funnel_analysis/models/staging/stg_events.sql
[0m16:50:10.292665 [info ] [MainThread]: 
[0m16:50:10.292829 [info ] [MainThread]:   compiled code at target/compiled/funnel_analysis/models/staging/stg_events.sql
[0m16:50:10.292968 [info ] [MainThread]: 
[0m16:50:10.293128 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 NO-OP=0 TOTAL=6
[0m16:50:10.295724 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3514478, "process_in_blocks": "0", "process_kernel_time": 0.567579, "process_mem_max_rss": "342425600", "process_out_blocks": "0", "process_user_time": 3.348593}
[0m16:50:10.295986 [debug] [MainThread]: Command `dbt run` failed at 16:50:10.295939 after 3.35 seconds
[0m16:50:10.296220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b935910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1699da850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1699da170>]}
[0m16:50:10.296416 [debug] [MainThread]: Flushing usage events
[0m16:50:10.749351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:40.200117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adf9d0>]}


============================== 16:50:40.203410 | b5ab888d-95f7-4d16-b60f-fb163aa95fbe ==============================
[0m16:50:40.203410 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:50:40.203745 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'quiet': 'False', 'write_json': 'True', 'use_colors': 'True', 'introspect': 'True', 'empty': 'False', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'profiles_dir': '/Users/barbaramariano/.dbt', 'partial_parse': 'True', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'version_check': 'True', 'log_format': 'default', 'log_cache_events': 'False'}
[0m16:50:41.925963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5ab888d-95f7-4d16-b60f-fb163aa95fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcfbb0>]}
[0m16:50:41.951709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5ab888d-95f7-4d16-b60f-fb163aa95fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142a6d370>]}
[0m16:50:41.951989 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:50:42.118505 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:50:42.182555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:50:42.182888 [debug] [MainThread]: Partial parsing: updated file: funnel_analysis://models/staging/stg_events.sql
[0m16:50:42.328417 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m16:50:42.328722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5ab888d-95f7-4d16-b60f-fb163aa95fbe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14787b050>]}
[0m16:50:42.366565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5ab888d-95f7-4d16-b60f-fb163aa95fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ac7b60>]}
[0m16:50:42.402161 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m16:50:42.404433 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m16:50:42.417334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5ab888d-95f7-4d16-b60f-fb163aa95fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142dc8130>]}
[0m16:50:42.417558 [info ] [MainThread]: Found 1 seed, 6 models, 5 data tests, 495 macros
[0m16:50:42.417717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5ab888d-95f7-4d16-b60f-fb163aa95fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d235f0>]}
[0m16:50:42.418609 [info ] [MainThread]: 
[0m16:50:42.418788 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m16:50:42.418913 [info ] [MainThread]: 
[0m16:50:42.419122 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:50:42.420962 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m16:50:42.421154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:43.172990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m16:50:43.174262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:43.308139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5ab888d-95f7-4d16-b60f-fb163aa95fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ba7dd0>]}
[0m16:50:43.309490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:43.317454 [debug] [Thread-1 (]: Began running node model.funnel_analysis.stg_events
[0m16:50:43.318363 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_events ............................... [RUN]
[0m16:50:43.319018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now model.funnel_analysis.stg_events)
[0m16:50:43.319481 [debug] [Thread-1 (]: Began compiling node model.funnel_analysis.stg_events
[0m16:50:43.330011 [debug] [Thread-1 (]: Writing injected SQL for node "model.funnel_analysis.stg_events"
[0m16:50:43.330767 [debug] [Thread-1 (]: Began executing node model.funnel_analysis.stg_events
[0m16:50:43.354312 [debug] [Thread-1 (]: Writing runtime sql for node "model.funnel_analysis.stg_events"
[0m16:50:43.354900 [debug] [Thread-1 (]: On model.funnel_analysis.stg_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.stg_events"} */


  create or replace view `funnel-analysis-473408`.`analytics`.`stg_events`
  OPTIONS()
  as --clean & standardize the raw seed (analytics.events) so types/text are consistent.



with raw as (
  select
    cast(user_id as int64)                              as user_id,
    timestamp(event_time)                               as event_ts,
    lower(event_name)                                   as event_name,
    cast(step as int64)                                 as step,
    lower(source)                                       as source,
    upper(country)                                      as country
  from `funnel-analysis-473408`.`analytics`.`events`   -- the seeded CSV table
  where lower(event_name) in ('signup','profile_completed','kyc_passed','first_payment')
)
select * from raw;


[0m16:50:43.355184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:44.261919 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:ced1acf5-57eb-43b6-9c4a-950a87514219&page=queryresults
[0m16:50:44.263316 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:ced1acf5-57eb-43b6-9c4a-950a87514219&page=queryresults
[0m16:50:44.284082 [debug] [Thread-1 (]: Database Error in model stg_events (models/staging/stg_events.sql)
  Not found: Table funnel-analysis-473408:analytics.events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/staging/stg_events.sql
[0m16:50:44.286666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ab888d-95f7-4d16-b60f-fb163aa95fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ce2d00>]}
[0m16:50:44.287550 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model analytics.stg_events ...................... [[31mERROR[0m in 0.97s]
[0m16:50:44.288384 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.stg_events
[0m16:50:44.288919 [debug] [Thread-7 (]: Marking all children of 'model.funnel_analysis.stg_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_events (models/staging/stg_events.sql)
  Not found: Table funnel-analysis-473408:analytics.events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/staging/stg_events.sql.
[0m16:50:44.290601 [debug] [Thread-2 (]: Began running node model.funnel_analysis.int_user_first_step_ts
[0m16:50:44.291004 [info ] [Thread-2 (]: 2 of 6 SKIP relation analytics.int_user_first_step_ts .......................... [[33mSKIP[0m]
[0m16:50:44.291349 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.int_user_first_step_ts
[0m16:50:44.291857 [debug] [Thread-3 (]: Began running node model.funnel_analysis.int_user_funnel_path
[0m16:50:44.292264 [info ] [Thread-3 (]: 3 of 6 SKIP relation analytics.int_user_funnel_path ............................ [[33mSKIP[0m]
[0m16:50:44.292603 [debug] [Thread-3 (]: Finished running node model.funnel_analysis.int_user_funnel_path
[0m16:50:44.293054 [debug] [Thread-1 (]: Began running node model.funnel_analysis.fct_funnel_by_source
[0m16:50:44.293417 [debug] [Thread-2 (]: Began running node model.funnel_analysis.fct_funnel_conversions
[0m16:50:44.293801 [debug] [Thread-4 (]: Began running node model.funnel_analysis.fct_funnel_by_cohort
[0m16:50:44.294166 [info ] [Thread-1 (]: 5 of 6 SKIP relation analytics.fct_funnel_by_source ............................ [[33mSKIP[0m]
[0m16:50:44.294577 [info ] [Thread-2 (]: 6 of 6 SKIP relation analytics.fct_funnel_conversions .......................... [[33mSKIP[0m]
[0m16:50:44.295204 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.fct_funnel_by_source
[0m16:50:44.294880 [info ] [Thread-4 (]: 4 of 6 SKIP relation analytics.fct_funnel_by_cohort ............................ [[33mSKIP[0m]
[0m16:50:44.295569 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.fct_funnel_conversions
[0m16:50:44.295902 [debug] [Thread-4 (]: Finished running node model.funnel_analysis.fct_funnel_by_cohort
[0m16:50:44.296842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:44.297290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:44.297495 [debug] [MainThread]: Connection 'model.funnel_analysis.stg_events' was properly closed.
[0m16:50:44.297763 [info ] [MainThread]: 
[0m16:50:44.298076 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m16:50:44.298786 [debug] [MainThread]: Command end result
[0m16:50:44.316883 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m16:50:44.319319 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m16:50:44.325309 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m16:50:44.326488 [info ] [MainThread]: 
[0m16:50:44.326831 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:50:44.327068 [info ] [MainThread]: 
[0m16:50:44.327314 [error] [MainThread]: [31mFailure in model stg_events (models/staging/stg_events.sql)[0m
[0m16:50:44.327518 [error] [MainThread]:   Database Error in model stg_events (models/staging/stg_events.sql)
  Not found: Table funnel-analysis-473408:analytics.events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/staging/stg_events.sql
[0m16:50:44.327665 [info ] [MainThread]: 
[0m16:50:44.327846 [info ] [MainThread]:   compiled code at target/compiled/funnel_analysis/models/staging/stg_events.sql
[0m16:50:44.328035 [info ] [MainThread]: 
[0m16:50:44.328215 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 NO-OP=0 TOTAL=6
[0m16:50:44.328944 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:50:44.332394 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.16568, "process_in_blocks": "0", "process_kernel_time": 0.527042, "process_mem_max_rss": "360022016", "process_out_blocks": "0", "process_user_time": 3.649868}
[0m16:50:44.332852 [debug] [MainThread]: Command `dbt run` failed at 16:50:44.332778 after 4.17 seconds
[0m16:50:44.333130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db3930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d7ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b96f50>]}
[0m16:50:44.333356 [debug] [MainThread]: Flushing usage events
[0m16:50:44.730296 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:12.768754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112141a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d67890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d679d0>]}


============================== 16:52:12.773755 | cabb0148-6c59-4e82-99bc-2043f61935f2 ==============================
[0m16:52:12.773755 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:52:12.774062 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'use_colors': 'True', 'profiles_dir': '/Users/barbaramariano/.dbt', 'no_print': 'None', 'write_json': 'True', 'partial_parse': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'empty': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ls --resource-type seed', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_cache_events': 'False'}
[0m16:52:14.567154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cabb0148-6c59-4e82-99bc-2043f61935f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111457bb0>]}
[0m16:52:14.594463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cabb0148-6c59-4e82-99bc-2043f61935f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159d65370>]}
[0m16:52:14.594860 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:52:14.769891 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:52:14.837230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:14.837429 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:14.858446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cabb0148-6c59-4e82-99bc-2043f61935f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15aa76250>]}
[0m16:52:14.895208 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m16:52:14.897945 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m16:52:14.915341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cabb0148-6c59-4e82-99bc-2043f61935f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15aaf9b80>]}
[0m16:52:14.915614 [info ] [MainThread]: Found 1 seed, 6 models, 5 data tests, 495 macros
[0m16:52:14.915783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cabb0148-6c59-4e82-99bc-2043f61935f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159e20ad0>]}
[0m16:52:14.916245 [info ] [MainThread]: funnel_analysis.events
[0m16:52:14.918836 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 2.192847, "process_in_blocks": "0", "process_kernel_time": 0.61138, "process_mem_max_rss": "343801856", "process_out_blocks": "0", "process_user_time": 3.262044}
[0m16:52:14.919191 [debug] [MainThread]: Command `dbt ls` succeeded at 16:52:14.919132 after 2.19 seconds
[0m16:52:14.919376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ae986d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aa5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15aab25d0>]}
[0m16:52:14.919525 [debug] [MainThread]: Flushing usage events
[0m16:52:15.386763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:42.904884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077141a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109163890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091639d0>]}


============================== 16:57:42.908300 | 663799a4-3ee7-4b13-94f6-f421a16096a7 ==============================
[0m16:57:42.908300 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:57:42.908687 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/barbaramariano/.dbt', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'log_format': 'default', 'empty': 'False', 'printer_width': '80', 'write_json': 'True', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'quiet': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'static_parser': 'True'}
[0m16:57:44.688477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '663799a4-3ee7-4b13-94f6-f421a16096a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107957bb0>]}
[0m16:57:44.718714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '663799a4-3ee7-4b13-94f6-f421a16096a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164f6d370>]}
[0m16:57:44.719149 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:57:44.905287 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:57:44.972227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:57:44.972462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:57:44.993230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '663799a4-3ee7-4b13-94f6-f421a16096a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165d76850>]}
[0m16:57:45.030110 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m16:57:45.031486 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m16:57:45.044038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '663799a4-3ee7-4b13-94f6-f421a16096a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164fc3d40>]}
[0m16:57:45.044263 [info ] [MainThread]: Found 1 seed, 6 models, 5 data tests, 495 macros
[0m16:57:45.044424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '663799a4-3ee7-4b13-94f6-f421a16096a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165920c90>]}
[0m16:57:45.045326 [info ] [MainThread]: 
[0m16:57:45.045502 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m16:57:45.045627 [info ] [MainThread]: 
[0m16:57:45.045853 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:57:45.047751 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m16:57:45.047953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:45.859210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m16:57:45.859601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:45.999719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '663799a4-3ee7-4b13-94f6-f421a16096a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165f507a0>]}
[0m16:57:46.000802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:46.005091 [debug] [Thread-1 (]: Began running node model.funnel_analysis.stg_events
[0m16:57:46.005769 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_events ............................... [RUN]
[0m16:57:46.006318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now model.funnel_analysis.stg_events)
[0m16:57:46.006760 [debug] [Thread-1 (]: Began compiling node model.funnel_analysis.stg_events
[0m16:57:46.013966 [debug] [Thread-1 (]: Writing injected SQL for node "model.funnel_analysis.stg_events"
[0m16:57:46.014702 [debug] [Thread-1 (]: Began executing node model.funnel_analysis.stg_events
[0m16:57:46.030644 [debug] [Thread-1 (]: Writing runtime sql for node "model.funnel_analysis.stg_events"
[0m16:57:46.031155 [debug] [Thread-1 (]: On model.funnel_analysis.stg_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.stg_events"} */


  create or replace view `funnel-analysis-473408`.`analytics`.`stg_events`
  OPTIONS()
  as --clean & standardize the raw seed (analytics.events) so types/text are consistent.



with raw as (
  select
    cast(user_id as int64)                              as user_id,
    timestamp(event_time)                               as event_ts,
    lower(event_name)                                   as event_name,
    cast(step as int64)                                 as step,
    lower(source)                                       as source,
    upper(country)                                      as country
  from `funnel-analysis-473408`.`analytics`.`events`   -- the seeded CSV table
  where lower(event_name) in ('signup','profile_completed','kyc_passed','first_payment')
)
select * from raw;


[0m16:57:46.031482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:46.253447 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:a4ddcc4b-8bd6-4d5a-8941-26d61c3dde98&page=queryresults
[0m16:57:46.254612 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:a4ddcc4b-8bd6-4d5a-8941-26d61c3dde98&page=queryresults
[0m16:57:46.270691 [debug] [Thread-1 (]: Database Error in model stg_events (models/staging/stg_events.sql)
  Not found: Table funnel-analysis-473408:analytics.events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/staging/stg_events.sql
[0m16:57:46.273247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '663799a4-3ee7-4b13-94f6-f421a16096a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1668d4290>]}
[0m16:57:46.273846 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model analytics.stg_events ...................... [[31mERROR[0m in 0.27s]
[0m16:57:46.274141 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.stg_events
[0m16:57:46.274586 [debug] [Thread-7 (]: Marking all children of 'model.funnel_analysis.stg_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_events (models/staging/stg_events.sql)
  Not found: Table funnel-analysis-473408:analytics.events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/staging/stg_events.sql.
[0m16:57:46.275530 [debug] [Thread-2 (]: Began running node model.funnel_analysis.int_user_first_step_ts
[0m16:57:46.275821 [info ] [Thread-2 (]: 2 of 6 SKIP relation analytics.int_user_first_step_ts .......................... [[33mSKIP[0m]
[0m16:57:46.276056 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.int_user_first_step_ts
[0m16:57:46.276311 [debug] [Thread-3 (]: Began running node model.funnel_analysis.int_user_funnel_path
[0m16:57:46.276500 [info ] [Thread-3 (]: 3 of 6 SKIP relation analytics.int_user_funnel_path ............................ [[33mSKIP[0m]
[0m16:57:46.276714 [debug] [Thread-3 (]: Finished running node model.funnel_analysis.int_user_funnel_path
[0m16:57:46.277022 [debug] [Thread-2 (]: Began running node model.funnel_analysis.fct_funnel_conversions
[0m16:57:46.277294 [debug] [Thread-1 (]: Began running node model.funnel_analysis.fct_funnel_by_source
[0m16:57:46.277676 [debug] [Thread-4 (]: Began running node model.funnel_analysis.fct_funnel_by_cohort
[0m16:57:46.278026 [info ] [Thread-2 (]: 6 of 6 SKIP relation analytics.fct_funnel_conversions .......................... [[33mSKIP[0m]
[0m16:57:46.278460 [info ] [Thread-1 (]: 5 of 6 SKIP relation analytics.fct_funnel_by_source ............................ [[33mSKIP[0m]
[0m16:57:46.279175 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.fct_funnel_conversions
[0m16:57:46.278937 [info ] [Thread-4 (]: 4 of 6 SKIP relation analytics.fct_funnel_by_cohort ............................ [[33mSKIP[0m]
[0m16:57:46.279386 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.fct_funnel_by_source
[0m16:57:46.279672 [debug] [Thread-4 (]: Finished running node model.funnel_analysis.fct_funnel_by_cohort
[0m16:57:46.280262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:57:46.280531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:46.280663 [debug] [MainThread]: Connection 'model.funnel_analysis.stg_events' was properly closed.
[0m16:57:46.280836 [info ] [MainThread]: 
[0m16:57:46.280977 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m16:57:46.281337 [debug] [MainThread]: Command end result
[0m16:57:46.304777 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m16:57:46.306071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m16:57:46.309615 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m16:57:46.309804 [info ] [MainThread]: 
[0m16:57:46.310000 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:57:46.310156 [info ] [MainThread]: 
[0m16:57:46.310355 [error] [MainThread]: [31mFailure in model stg_events (models/staging/stg_events.sql)[0m
[0m16:57:46.310608 [error] [MainThread]:   Database Error in model stg_events (models/staging/stg_events.sql)
  Not found: Table funnel-analysis-473408:analytics.events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/staging/stg_events.sql
[0m16:57:46.310855 [info ] [MainThread]: 
[0m16:57:46.311111 [info ] [MainThread]:   compiled code at target/compiled/funnel_analysis/models/staging/stg_events.sql
[0m16:57:46.311314 [info ] [MainThread]: 
[0m16:57:46.311637 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 NO-OP=0 TOTAL=6
[0m16:57:46.315654 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4508023, "process_in_blocks": "0", "process_kernel_time": 0.54396, "process_mem_max_rss": "351354880", "process_out_blocks": "0", "process_user_time": 3.469565}
[0m16:57:46.315991 [debug] [MainThread]: Command `dbt run` failed at 16:57:46.315933 after 3.45 seconds
[0m16:57:46.316263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165fe5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1659dab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1659dac10>]}
[0m16:57:46.316472 [debug] [MainThread]: Flushing usage events
[0m16:57:46.774439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:48.274844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047001a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106067890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060679d0>]}


============================== 16:57:48.277879 | 04290bcf-6b5d-47bb-87e6-637b395baaf2 ==============================
[0m16:57:48.277879 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:57:48.278218 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'partial_parse': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'debug': 'False', 'empty': 'None', 'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/Users/barbaramariano/.dbt', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'log_format': 'default', 'no_print': 'None', 'quiet': 'False'}
[0m16:57:49.839567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04290bcf-6b5d-47bb-87e6-637b395baaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104843bb0>]}
[0m16:57:49.865813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04290bcf-6b5d-47bb-87e6-637b395baaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e65370>]}
[0m16:57:49.866153 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:57:50.032522 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:57:50.096453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:57:50.096656 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:57:50.118523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04290bcf-6b5d-47bb-87e6-637b395baaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156376250>]}
[0m16:57:50.155711 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m16:57:50.156749 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m16:57:50.174471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04290bcf-6b5d-47bb-87e6-637b395baaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1565bb980>]}
[0m16:57:50.174760 [info ] [MainThread]: Found 1 seed, 6 models, 5 data tests, 495 macros
[0m16:57:50.174932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04290bcf-6b5d-47bb-87e6-637b395baaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1565498d0>]}
[0m16:57:50.175867 [info ] [MainThread]: 
[0m16:57:50.176041 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m16:57:50.176162 [info ] [MainThread]: 
[0m16:57:50.176384 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:57:50.178414 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408_analytics'
[0m16:57:50.178850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:50.877290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04290bcf-6b5d-47bb-87e6-637b395baaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1565507a0>]}
[0m16:57:50.878030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:50.880263 [debug] [Thread-4 (]: Began running node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m16:57:50.880568 [debug] [Thread-1 (]: Began running node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m16:57:50.880815 [debug] [Thread-3 (]: Began running node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m16:57:50.881017 [debug] [Thread-2 (]: Began running node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m16:57:50.881248 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_events_user_id .................................. [RUN]
[0m16:57:50.881529 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment  [RUN]
[0m16:57:50.881773 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_events_event_ts ................................. [RUN]
[0m16:57:50.882017 [info ] [Thread-2 (]: 2 of 5 START test not_null_int_user_funnel_path_user_id ........................ [RUN]
[0m16:57:50.882362 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4'
[0m16:57:50.882601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2)
[0m16:57:50.882865 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0'
[0m16:57:50.883123 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634'
[0m16:57:50.883334 [debug] [Thread-4 (]: Began compiling node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m16:57:50.883533 [debug] [Thread-1 (]: Began compiling node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m16:57:50.883719 [debug] [Thread-3 (]: Began compiling node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m16:57:50.883899 [debug] [Thread-2 (]: Began compiling node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m16:57:50.900493 [debug] [Thread-1 (]: Writing injected SQL for node "test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2"
[0m16:57:50.901559 [debug] [Thread-4 (]: Writing injected SQL for node "test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4"
[0m16:57:50.903669 [debug] [Thread-3 (]: Writing injected SQL for node "test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0"
[0m16:57:50.905433 [debug] [Thread-2 (]: Writing injected SQL for node "test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634"
[0m16:57:50.905974 [debug] [Thread-4 (]: Began executing node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m16:57:50.906179 [debug] [Thread-3 (]: Began executing node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m16:57:50.916991 [debug] [Thread-4 (]: Writing runtime sql for node "test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4"
[0m16:57:50.917181 [debug] [Thread-1 (]: Began executing node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m16:57:50.917338 [debug] [Thread-2 (]: Began executing node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m16:57:50.918315 [debug] [Thread-3 (]: Writing runtime sql for node "test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0"
[0m16:57:50.919276 [debug] [Thread-1 (]: Writing runtime sql for node "test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2"
[0m16:57:50.920343 [debug] [Thread-2 (]: Writing runtime sql for node "test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634"
[0m16:57:50.920722 [debug] [Thread-4 (]: On test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `funnel-analysis-473408`.`analytics`.`stg_events`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:57:50.920923 [debug] [Thread-3 (]: On test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from `funnel-analysis-473408`.`analytics`.`stg_events`
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m16:57:50.921124 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:57:50.921293 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:57:50.921461 [debug] [Thread-1 (]: On test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_name as value_field,
        count(*) as n_records

    from `funnel-analysis-473408`.`analytics`.`stg_events`
    group by event_name

)

select *
from all_values
where value_field not in (
    'signup','profile_completed','kyc_passed','first_payment'
)



  
  
      
    ) dbt_internal_test
[0m16:57:50.921640 [debug] [Thread-2 (]: On test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:57:50.922596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:50.922863 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:57:51.098132 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:31a22921-a7ca-4858-a916-eafbe7c00578&page=queryresults
[0m16:57:51.098772 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:31a22921-a7ca-4858-a916-eafbe7c00578&page=queryresults
[0m16:57:51.111578 [debug] [Thread-4 (]: Database Error in test not_null_stg_events_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.stg_events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/not_null_stg_events_user_id.sql
[0m16:57:51.112300 [error] [Thread-4 (]: 4 of 5 ERROR not_null_stg_events_user_id ....................................... [[31mERROR[0m in 0.23s]
[0m16:57:51.112808 [debug] [Thread-4 (]: Finished running node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m16:57:51.113105 [debug] [Thread-4 (]: Began running node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m16:57:51.113483 [debug] [Thread-7 (]: Marking all children of 'test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_events_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.stg_events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/not_null_stg_events_user_id.sql.
[0m16:57:51.113789 [info ] [Thread-4 (]: 5 of 5 START test unique_int_user_funnel_path_user_id .......................... [RUN]
[0m16:57:51.115102 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4, now test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6)
[0m16:57:51.115512 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:f9ad4fa8-6e93-408b-8c36-6e873b253d9c&page=queryresults
[0m16:57:51.115803 [debug] [Thread-4 (]: Began compiling node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m16:57:51.116145 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:f9ad4fa8-6e93-408b-8c36-6e873b253d9c&page=queryresults
[0m16:57:51.121174 [debug] [Thread-4 (]: Writing injected SQL for node "test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6"
[0m16:57:51.125521 [debug] [Thread-2 (]: Database Error in test not_null_int_user_funnel_path_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.int_user_funnel_path was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/not_null_int_user_funnel_path_user_id.sql
[0m16:57:51.125884 [error] [Thread-2 (]: 2 of 5 ERROR not_null_int_user_funnel_path_user_id ............................. [[31mERROR[0m in 0.24s]
[0m16:57:51.126241 [debug] [Thread-2 (]: Finished running node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m16:57:51.126556 [debug] [Thread-7 (]: Marking all children of 'test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634' to be skipped because of status 'error'.  Reason: Database Error in test not_null_int_user_funnel_path_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.int_user_funnel_path was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/not_null_int_user_funnel_path_user_id.sql.
[0m16:57:51.126855 [debug] [Thread-4 (]: Began executing node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m16:57:51.128306 [debug] [Thread-4 (]: Writing runtime sql for node "test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6"
[0m16:57:51.128711 [debug] [Thread-4 (]: On test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:57:51.128946 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:57:51.137074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:e2a44688-068a-4241-9025-4b67f6796a54&page=queryresults
[0m16:57:51.137374 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:e2a44688-068a-4241-9025-4b67f6796a54&page=queryresults
[0m16:57:51.141266 [debug] [Thread-1 (]: Database Error in test accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.stg_events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/accepted_values_stg_events_0c8febbdeadc2561010697ed2391e3c3.sql
[0m16:57:51.141624 [error] [Thread-1 (]: 1 of 5 ERROR accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment  [[31mERROR[0m in 0.26s]
[0m16:57:51.142076 [debug] [Thread-1 (]: Finished running node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m16:57:51.142392 [debug] [Thread-7 (]: Marking all children of 'test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.stg_events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/accepted_values_stg_events_0c8febbdeadc2561010697ed2391e3c3.sql.
[0m16:57:51.847532 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:c500cb5a-8dc0-403b-9150-d7b7ffa66317&page=queryresults
[0m16:57:51.849139 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:c500cb5a-8dc0-403b-9150-d7b7ffa66317&page=queryresults
[0m16:57:51.850538 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:b49b6462-3c0d-4982-ab40-3cdf2dd8a776&page=queryresults
[0m16:57:51.858879 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:b49b6462-3c0d-4982-ab40-3cdf2dd8a776&page=queryresults
[0m16:57:51.869130 [debug] [Thread-4 (]: Database Error in test unique_int_user_funnel_path_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.int_user_funnel_path was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/unique_int_user_funnel_path_user_id.sql
[0m16:57:51.870007 [error] [Thread-4 (]: 5 of 5 ERROR unique_int_user_funnel_path_user_id ............................... [[31mERROR[0m in 0.75s]
[0m16:57:51.872741 [debug] [Thread-3 (]: Database Error in test not_null_stg_events_event_ts (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.stg_events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/not_null_stg_events_event_ts.sql
[0m16:57:51.873181 [debug] [Thread-4 (]: Finished running node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m16:57:51.873561 [error] [Thread-3 (]: 3 of 5 ERROR not_null_stg_events_event_ts ...................................... [[31mERROR[0m in 0.99s]
[0m16:57:51.873975 [debug] [Thread-7 (]: Marking all children of 'test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6' to be skipped because of status 'error'.  Reason: Database Error in test unique_int_user_funnel_path_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.int_user_funnel_path was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/unique_int_user_funnel_path_user_id.sql.
[0m16:57:51.874390 [debug] [Thread-3 (]: Finished running node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m16:57:51.874796 [debug] [Thread-7 (]: Marking all children of 'test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_events_event_ts (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.stg_events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/not_null_stg_events_event_ts.sql.
[0m16:57:51.875895 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:57:51.876342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:51.876645 [debug] [MainThread]: Connection 'test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2' was properly closed.
[0m16:57:51.876930 [debug] [MainThread]: Connection 'test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6' was properly closed.
[0m16:57:51.877155 [debug] [MainThread]: Connection 'test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0' was properly closed.
[0m16:57:51.877379 [debug] [MainThread]: Connection 'test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634' was properly closed.
[0m16:57:51.877663 [info ] [MainThread]: 
[0m16:57:51.877922 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 1.70 seconds (1.70s).
[0m16:57:51.878973 [debug] [MainThread]: Command end result
[0m16:57:51.896576 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m16:57:51.898436 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m16:57:51.902728 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m16:57:51.902918 [info ] [MainThread]: 
[0m16:57:51.903132 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m16:57:51.903299 [info ] [MainThread]: 
[0m16:57:51.903502 [error] [MainThread]: [31mFailure in test not_null_stg_events_user_id (models/schema.yml)[0m
[0m16:57:51.903688 [error] [MainThread]:   Database Error in test not_null_stg_events_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.stg_events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/not_null_stg_events_user_id.sql
[0m16:57:51.903833 [info ] [MainThread]: 
[0m16:57:51.904000 [info ] [MainThread]:   compiled code at target/compiled/funnel_analysis/models/schema.yml/not_null_stg_events_user_id.sql
[0m16:57:51.904137 [info ] [MainThread]: 
[0m16:57:51.904310 [error] [MainThread]: [31mFailure in test not_null_int_user_funnel_path_user_id (models/schema.yml)[0m
[0m16:57:51.904486 [error] [MainThread]:   Database Error in test not_null_int_user_funnel_path_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.int_user_funnel_path was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/not_null_int_user_funnel_path_user_id.sql
[0m16:57:51.904621 [info ] [MainThread]: 
[0m16:57:51.904785 [info ] [MainThread]:   compiled code at target/compiled/funnel_analysis/models/schema.yml/not_null_int_user_funnel_path_user_id.sql
[0m16:57:51.904919 [info ] [MainThread]: 
[0m16:57:51.905089 [error] [MainThread]: [31mFailure in test accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment (models/schema.yml)[0m
[0m16:57:51.905270 [error] [MainThread]:   Database Error in test accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.stg_events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/accepted_values_stg_events_0c8febbdeadc2561010697ed2391e3c3.sql
[0m16:57:51.905408 [info ] [MainThread]: 
[0m16:57:51.905573 [info ] [MainThread]:   compiled code at target/compiled/funnel_analysis/models/schema.yml/accepted_values_stg_events_0c8febbdeadc2561010697ed2391e3c3.sql
[0m16:57:51.905705 [info ] [MainThread]: 
[0m16:57:51.905871 [error] [MainThread]: [31mFailure in test unique_int_user_funnel_path_user_id (models/schema.yml)[0m
[0m16:57:51.906042 [error] [MainThread]:   Database Error in test unique_int_user_funnel_path_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.int_user_funnel_path was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/unique_int_user_funnel_path_user_id.sql
[0m16:57:51.906173 [info ] [MainThread]: 
[0m16:57:51.906328 [info ] [MainThread]:   compiled code at target/compiled/funnel_analysis/models/schema.yml/unique_int_user_funnel_path_user_id.sql
[0m16:57:51.906459 [info ] [MainThread]: 
[0m16:57:51.906623 [error] [MainThread]: [31mFailure in test not_null_stg_events_event_ts (models/schema.yml)[0m
[0m16:57:51.906792 [error] [MainThread]:   Database Error in test not_null_stg_events_event_ts (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.stg_events was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/not_null_stg_events_event_ts.sql
[0m16:57:51.906916 [info ] [MainThread]: 
[0m16:57:51.907067 [info ] [MainThread]:   compiled code at target/compiled/funnel_analysis/models/schema.yml/not_null_stg_events_event_ts.sql
[0m16:57:51.907199 [info ] [MainThread]: 
[0m16:57:51.907359 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=5
[0m16:57:51.909067 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.6683662, "process_in_blocks": "0", "process_kernel_time": 0.525117, "process_mem_max_rss": "343228416", "process_out_blocks": "0", "process_user_time": 3.431686}
[0m16:57:51.909418 [debug] [MainThread]: Command `dbt test` failed at 16:57:51.909365 after 3.67 seconds
[0m16:57:51.909660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1565db960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1565db800>]}
[0m16:57:51.909864 [debug] [MainThread]: Flushing usage events
[0m16:57:52.290266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:40.129410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f33890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f339d0>]}


============================== 17:00:40.132859 | 5cf68390-96f2-410b-85a7-07daa8fda090 ==============================
[0m17:00:40.132859 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:00:40.133205 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ls --resource-type model', 'static_parser': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'profiles_dir': '/Users/barbaramariano/.dbt', 'fail_fast': 'False', 'quiet': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'no_print': 'None', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None'}
[0m17:00:41.891776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cf68390-96f2-410b-85a7-07daa8fda090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622bbb0>]}
[0m17:00:41.918201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cf68390-96f2-410b-85a7-07daa8fda090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157669370>]}
[0m17:00:41.918500 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:00:42.084830 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:00:42.153020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:42.153231 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:42.174208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cf68390-96f2-410b-85a7-07daa8fda090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16027a250>]}
[0m17:00:42.211899 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:00:42.213212 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:00:42.224810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cf68390-96f2-410b-85a7-07daa8fda090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1602f9b80>]}
[0m17:00:42.225033 [info ] [MainThread]: Found 1 seed, 6 models, 5 data tests, 495 macros
[0m17:00:42.225196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cf68390-96f2-410b-85a7-07daa8fda090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157720ad0>]}
[0m17:00:42.225626 [info ] [MainThread]: funnel_analysis.marts.fct_funnel_by_cohort
[0m17:00:42.225780 [info ] [MainThread]: funnel_analysis.marts.fct_funnel_by_source
[0m17:00:42.225896 [info ] [MainThread]: funnel_analysis.marts.fct_funnel_conversions
[0m17:00:42.226002 [info ] [MainThread]: funnel_analysis.intermediate.int_user_first_step_ts
[0m17:00:42.226106 [info ] [MainThread]: funnel_analysis.intermediate.int_user_funnel_path
[0m17:00:42.226211 [info ] [MainThread]: funnel_analysis.staging.stg_events
[0m17:00:42.227684 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 2.1332603, "process_in_blocks": "0", "process_kernel_time": 0.590442, "process_mem_max_rss": "353058816", "process_out_blocks": "0", "process_user_time": 3.246372}
[0m17:00:42.228000 [debug] [MainThread]: Command `dbt ls` succeeded at 17:00:42.227951 after 2.13 seconds
[0m17:00:42.228164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1605981f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d75e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1605565d0>]}
[0m17:00:42.228312 [debug] [MainThread]: Flushing usage events
[0m17:00:42.666846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:27.230973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105303890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053039d0>]}


============================== 17:06:27.233921 | e3014014-0a64-4fec-a821-f954b600395a ==============================
[0m17:06:27.233921 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:06:27.234220 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'target_path': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'static_parser': 'True', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'use_colors': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'profiles_dir': '/Users/barbaramariano/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'partial_parse': 'True', 'printer_width': '80', 'debug': 'False', 'warn_error': 'None'}
[0m17:06:28.918589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3014014-0a64-4fec-a821-f954b600395a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045fbbb0>]}
[0m17:06:28.945708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3014014-0a64-4fec-a821-f954b600395a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144665370>]}
[0m17:06:28.946015 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:06:29.105497 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:06:29.173290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:06:29.173488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:06:29.195097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3014014-0a64-4fec-a821-f954b600395a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144c7a850>]}
[0m17:06:29.232026 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:06:29.233622 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:06:29.246852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3014014-0a64-4fec-a821-f954b600395a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144cf9d60>]}
[0m17:06:29.247094 [info ] [MainThread]: Found 1 seed, 6 models, 5 data tests, 495 macros
[0m17:06:29.247259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3014014-0a64-4fec-a821-f954b600395a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144722970>]}
[0m17:06:29.248095 [info ] [MainThread]: 
[0m17:06:29.248270 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:06:29.248392 [info ] [MainThread]: 
[0m17:06:29.248611 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:06:29.249003 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m17:06:29.249193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:30.020088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m17:06:30.021833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:30.147785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3014014-0a64-4fec-a821-f954b600395a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144e507a0>]}
[0m17:06:30.148811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:30.153252 [debug] [Thread-1 (]: Began running node seed.funnel_analysis.events
[0m17:06:30.154074 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.events ........................................ [RUN]
[0m17:06:30.154666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now seed.funnel_analysis.events)
[0m17:06:30.155084 [debug] [Thread-1 (]: Began compiling node seed.funnel_analysis.events
[0m17:06:30.155486 [debug] [Thread-1 (]: Began executing node seed.funnel_analysis.events
[0m17:06:30.216027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:32.517517 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:10:00Z"; line_number: 2 byte_offset_to_start_of_line: 50 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:15:00Z"; line_number: 3 byte_offset_to_start_of_line: 89 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:15:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T09:00:00Z"; line_number: 4 byte_offset_to_start_of_line: 139 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T09:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-21T10:20:00Z"; line_number: 5 byte_offset_to_start_of_line: 182 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-21T10:20:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:12:00Z"; line_number: 6 byte_offset_to_start_of_line: 228 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:12:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:16:00Z"; line_number: 7 byte_offset_to_start_of_line: 271 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:16:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T11:00:00Z"; line_number: 8 byte_offset_to_start_of_line: 325 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T11:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T12:10:00Z"; line_number: 9 byte_offset_to_start_of_line: 368 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T12:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T14:20:00Z"; line_number: 10 byte_offset_to_start_of_line: 422 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T14:20:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m17:06:32.532264 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/base.py", line 363, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/base.py", line 310, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/base.py", line 410, in run
    return self.execute(compiled_node, manifest)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/run.py", line 336, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/task/run.py", line 296, in _execute_model
    result = MacroGenerator(
        materialization_macro, context, stack=context["context_macro_stack"]
    )()
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 109, in macro
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/adapters/bigquery/impl.py", line 683, in load_dataframe
    self.connections.write_dataframe_to_table(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        client,
        ^^^^^^^
    ...<6 lines>...
        fallback_timeout=300,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/adapters/bigquery/connections.py", line 486, in write_dataframe_to_table
    self._write_file_to_table(client, file_path, table, load_config, fallback_timeout)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/dbt/adapters/bigquery/connections.py", line 518, in _write_file_to_table
    response = job.result(retry=self._retry.create_retry(fallback=fallback_timeout))
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/barbaramariano/repositories/funnel_analysis/.venv/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:10:00Z"; line_number: 2 byte_offset_to_start_of_line: 50 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:15:00Z"; line_number: 3 byte_offset_to_start_of_line: 89 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:15:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T09:00:00Z"; line_number: 4 byte_offset_to_start_of_line: 139 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T09:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-21T10:20:00Z"; line_number: 5 byte_offset_to_start_of_line: 182 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-21T10:20:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:12:00Z"; line_number: 6 byte_offset_to_start_of_line: 228 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:12:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:16:00Z"; line_number: 7 byte_offset_to_start_of_line: 271 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:16:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T11:00:00Z"; line_number: 8 byte_offset_to_start_of_line: 325 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T11:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T12:10:00Z"; line_number: 9 byte_offset_to_start_of_line: 368 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T12:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T14:20:00Z"; line_number: 10 byte_offset_to_start_of_line: 422 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T14:20:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.

[0m17:06:32.535581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3014014-0a64-4fec-a821-f954b600395a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1453d9850>]}
[0m17:06:32.536496 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file analytics.events ................................ [[31mERROR[0m in 2.38s]
[0m17:06:32.537279 [debug] [Thread-1 (]: Finished running node seed.funnel_analysis.events
[0m17:06:32.537953 [debug] [Thread-7 (]: Marking all children of 'seed.funnel_analysis.events' to be skipped because of status 'error'.  Reason: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:10:00Z"; line_number: 2 byte_offset_to_start_of_line: 50 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:15:00Z"; line_number: 3 byte_offset_to_start_of_line: 89 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:15:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T09:00:00Z"; line_number: 4 byte_offset_to_start_of_line: 139 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T09:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-21T10:20:00Z"; line_number: 5 byte_offset_to_start_of_line: 182 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-21T10:20:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:12:00Z"; line_number: 6 byte_offset_to_start_of_line: 228 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:12:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:16:00Z"; line_number: 7 byte_offset_to_start_of_line: 271 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:16:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T11:00:00Z"; line_number: 8 byte_offset_to_start_of_line: 325 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T11:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T12:10:00Z"; line_number: 9 byte_offset_to_start_of_line: 368 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T12:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T14:20:00Z"; line_number: 10 byte_offset_to_start_of_line: 422 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T14:20:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format..
[0m17:06:32.540654 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:32.541505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:32.541918 [debug] [MainThread]: Connection 'seed.funnel_analysis.events' was properly closed.
[0m17:06:32.542522 [info ] [MainThread]: 
[0m17:06:32.542894 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m17:06:32.543749 [debug] [MainThread]: Command end result
[0m17:06:32.561751 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:06:32.563805 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:06:32.571092 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m17:06:32.571307 [info ] [MainThread]: 
[0m17:06:32.571880 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:06:32.572060 [info ] [MainThread]: 
[0m17:06:32.572279 [error] [MainThread]: [31mFailure in seed events (seeds/events.csv)[0m
[0m17:06:32.572597 [error] [MainThread]:   400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 9; errors: 9; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:10:00Z"; line_number: 2 byte_offset_to_start_of_line: 50 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:15:00Z"; line_number: 3 byte_offset_to_start_of_line: 89 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:15:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T09:00:00Z"; line_number: 4 byte_offset_to_start_of_line: 139 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T09:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-21T10:20:00Z"; line_number: 5 byte_offset_to_start_of_line: 182 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-21T10:20:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:12:00Z"; line_number: 6 byte_offset_to_start_of_line: 228 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:12:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T08:16:00Z"; line_number: 7 byte_offset_to_start_of_line: 271 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T08:16:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T11:00:00Z"; line_number: 8 byte_offset_to_start_of_line: 325 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T11:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T12:10:00Z"; line_number: 9 byte_offset_to_start_of_line: 368 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T12:10:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-20T14:20:00Z"; line_number: 10 byte_offset_to_start_of_line: 422 column_index: 1 column_name: "event_time" column_type: DATETIME value: "2025-09-20T14:20:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m17:06:32.572962 [info ] [MainThread]: 
[0m17:06:32.573212 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:06:32.576674 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 5.3774176, "process_in_blocks": "0", "process_kernel_time": 0.524033, "process_mem_max_rss": "346292224", "process_out_blocks": "0", "process_user_time": 3.252478}
[0m17:06:32.577695 [debug] [MainThread]: Command `dbt seed` failed at 17:06:32.577614 after 5.38 seconds
[0m17:06:32.578205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144eee2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144edb2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144edb250>]}
[0m17:06:32.578470 [debug] [MainThread]: Flushing usage events
[0m17:06:33.020397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:04.514187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046dc1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552f9d0>]}


============================== 17:09:04.517656 | ebf49fd6-9308-4e82-af91-db0fa7e63138 ==============================
[0m17:09:04.517656 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:09:04.517997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/barbaramariano/.dbt', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'use_colors': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'invocation_command': 'dbt seed', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'quiet': 'False'}
[0m17:09:06.396389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebf49fd6-9308-4e82-af91-db0fa7e63138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481fbb0>]}
[0m17:09:06.424890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebf49fd6-9308-4e82-af91-db0fa7e63138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e36d370>]}
[0m17:09:06.425293 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:09:06.589426 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:09:06.637427 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:09:06.637705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ebf49fd6-9308-4e82-af91-db0fa7e63138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e97a550>]}
[0m17:09:07.176707 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:09:07.177025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ebf49fd6-9308-4e82-af91-db0fa7e63138', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ea7b5c0>]}
[0m17:09:07.343465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebf49fd6-9308-4e82-af91-db0fa7e63138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15eeee430>]}
[0m17:09:07.380196 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:09:07.381484 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:09:07.393603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebf49fd6-9308-4e82-af91-db0fa7e63138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ee97ee0>]}
[0m17:09:07.393840 [info ] [MainThread]: Found 6 models, 1 seed, 5 data tests, 495 macros
[0m17:09:07.394001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebf49fd6-9308-4e82-af91-db0fa7e63138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ee79550>]}
[0m17:09:07.394831 [info ] [MainThread]: 
[0m17:09:07.394997 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:09:07.395114 [info ] [MainThread]: 
[0m17:09:07.395337 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:09:07.395739 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m17:09:07.395939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:08.190960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m17:09:08.191760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:08.340211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebf49fd6-9308-4e82-af91-db0fa7e63138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15efc9440>]}
[0m17:09:08.340700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:08.343301 [debug] [Thread-1 (]: Began running node seed.funnel_analysis.events
[0m17:09:08.343687 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.events ........................................ [RUN]
[0m17:09:08.343961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now seed.funnel_analysis.events)
[0m17:09:08.344159 [debug] [Thread-1 (]: Began compiling node seed.funnel_analysis.events
[0m17:09:08.344347 [debug] [Thread-1 (]: Began executing node seed.funnel_analysis.events
[0m17:09:08.397582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:10.542091 [debug] [Thread-1 (]: On seed.funnel_analysis.events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "seed.funnel_analysis.events"} */

    alter table `funnel-analysis-473408`.`analytics`.`events` set OPTIONS()
  
[0m17:09:10.706967 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:2f3db8d3-189b-4892-bfcf-e4e15f9318a6&page=queryresults
[0m17:09:10.882435 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.funnel_analysis.events"
[0m17:09:10.909083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebf49fd6-9308-4e82-af91-db0fa7e63138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030e36b0>]}
[0m17:09:10.909686 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics.events .................................... [[32mINSERT 9[0m in 2.56s]
[0m17:09:10.910183 [debug] [Thread-1 (]: Finished running node seed.funnel_analysis.events
[0m17:09:10.911410 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:10.911975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:10.912203 [debug] [MainThread]: Connection 'seed.funnel_analysis.events' was properly closed.
[0m17:09:10.912413 [info ] [MainThread]: 
[0m17:09:10.912619 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m17:09:10.913064 [debug] [MainThread]: Command end result
[0m17:09:10.929668 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:09:10.931141 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:09:10.934418 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m17:09:10.934596 [info ] [MainThread]: 
[0m17:09:10.934800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:10.934942 [info ] [MainThread]: 
[0m17:09:10.935113 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:09:10.935405 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:09:10.937991 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.461668, "process_in_blocks": "0", "process_kernel_time": 0.596352, "process_mem_max_rss": "360136704", "process_out_blocks": "0", "process_user_time": 4.230331}
[0m17:09:10.938297 [debug] [MainThread]: Command `dbt seed` succeeded at 17:09:10.938241 after 6.46 seconds
[0m17:09:10.938506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ecbe7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ec7d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105581550>]}
[0m17:09:10.938694 [debug] [MainThread]: Flushing usage events
[0m17:09:11.364354 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:33.026468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a181a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e67890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e679d0>]}


============================== 17:10:33.029713 | 78bc44cb-202e-4785-ac74-62d101e246da ==============================
[0m17:10:33.029713 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:10:33.030067 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'printer_width': '80', 'warn_error': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'empty': 'False', 'static_parser': 'True', 'quiet': 'False', 'no_print': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/barbaramariano/.dbt', 'log_format': 'default', 'introspect': 'True', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs'}
[0m17:10:34.816620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78bc44cb-202e-4785-ac74-62d101e246da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b57bb0>]}
[0m17:10:34.842526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78bc44cb-202e-4785-ac74-62d101e246da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15636d370>]}
[0m17:10:34.842836 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:10:35.011389 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:10:35.082721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:10:35.082966 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:10:35.104314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78bc44cb-202e-4785-ac74-62d101e246da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15687e950>]}
[0m17:10:35.140617 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:10:35.142034 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:10:35.154208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78bc44cb-202e-4785-ac74-62d101e246da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1563c3d40>]}
[0m17:10:35.154428 [info ] [MainThread]: Found 6 models, 1 seed, 5 data tests, 495 macros
[0m17:10:35.154586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78bc44cb-202e-4785-ac74-62d101e246da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1565220b0>]}
[0m17:10:35.155493 [info ] [MainThread]: 
[0m17:10:35.155661 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:10:35.155780 [info ] [MainThread]: 
[0m17:10:35.155997 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:10:35.157808 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m17:10:35.157992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:35.927337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m17:10:35.928229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:36.064585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78bc44cb-202e-4785-ac74-62d101e246da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156a24d50>]}
[0m17:10:36.065629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:36.070279 [debug] [Thread-1 (]: Began running node model.funnel_analysis.stg_events
[0m17:10:36.071070 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_events ............................... [RUN]
[0m17:10:36.071674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now model.funnel_analysis.stg_events)
[0m17:10:36.072138 [debug] [Thread-1 (]: Began compiling node model.funnel_analysis.stg_events
[0m17:10:36.084194 [debug] [Thread-1 (]: Writing injected SQL for node "model.funnel_analysis.stg_events"
[0m17:10:36.085551 [debug] [Thread-1 (]: Began executing node model.funnel_analysis.stg_events
[0m17:10:36.107169 [debug] [Thread-1 (]: Writing runtime sql for node "model.funnel_analysis.stg_events"
[0m17:10:36.107900 [debug] [Thread-1 (]: On model.funnel_analysis.stg_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.stg_events"} */


  create or replace view `funnel-analysis-473408`.`analytics`.`stg_events`
  OPTIONS()
  as --clean & standardize the raw seed (analytics.events) so types/text are consistent.



with raw as (
  select
    cast(user_id as int64)                              as user_id,
    timestamp(event_time)                               as event_ts,
    lower(event_name)                                   as event_name,
    cast(step as int64)                                 as step,
    lower(source)                                       as source,
    upper(country)                                      as country
  from `funnel-analysis-473408`.`analytics`.`events`   -- the seeded CSV table
  where lower(event_name) in ('signup','profile_completed','kyc_passed','first_payment')
)
select * from raw;


[0m17:10:36.108204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:36.372346 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:8bab78b2-a091-4fe6-b86d-88edffad33f2&page=queryresults
[0m17:10:36.611090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78bc44cb-202e-4785-ac74-62d101e246da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156b51550>]}
[0m17:10:36.611567 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_events .......................... [[32mCREATE VIEW (0 processed)[0m in 0.54s]
[0m17:10:36.611920 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.stg_events
[0m17:10:36.612347 [debug] [Thread-2 (]: Began running node model.funnel_analysis.int_user_first_step_ts
[0m17:10:36.612651 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.int_user_first_step_ts ................... [RUN]
[0m17:10:36.612956 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.funnel_analysis.int_user_first_step_ts'
[0m17:10:36.613144 [debug] [Thread-2 (]: Began compiling node model.funnel_analysis.int_user_first_step_ts
[0m17:10:36.614728 [debug] [Thread-2 (]: Writing injected SQL for node "model.funnel_analysis.int_user_first_step_ts"
[0m17:10:36.615158 [debug] [Thread-2 (]: Began executing node model.funnel_analysis.int_user_first_step_ts
[0m17:10:36.616755 [debug] [Thread-2 (]: Writing runtime sql for node "model.funnel_analysis.int_user_first_step_ts"
[0m17:10:36.617162 [debug] [Thread-2 (]: On model.funnel_analysis.int_user_first_step_ts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.int_user_first_step_ts"} */


  create or replace view `funnel-analysis-473408`.`analytics`.`int_user_first_step_ts`
  OPTIONS()
  as -- find the first time each user hit each funnel step



select
  user_id,
  event_name,
  min(event_ts) as first_ts
from `funnel-analysis-473408`.`analytics`.`stg_events`
group by 1,2;;


[0m17:10:36.617372 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:10:36.722003 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:76793535-c1cd-4ba4-b7e9-78da94c8ed4c&page=queryresults
[0m17:10:36.722535 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:76793535-c1cd-4ba4-b7e9-78da94c8ed4c&page=queryresults
[0m17:10:36.734351 [debug] [Thread-2 (]: Database Error in model int_user_first_step_ts (models/intermediate/int_user_first_step_ts.sql)
  Syntax error: Unexpected ";" at [15:14]
  compiled code at target/run/funnel_analysis/models/intermediate/int_user_first_step_ts.sql
[0m17:10:36.734813 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78bc44cb-202e-4785-ac74-62d101e246da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156addde0>]}
[0m17:10:36.735464 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model analytics.int_user_first_step_ts .......... [[31mERROR[0m in 0.12s]
[0m17:10:36.736067 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.int_user_first_step_ts
[0m17:10:36.736467 [debug] [Thread-7 (]: Marking all children of 'model.funnel_analysis.int_user_first_step_ts' to be skipped because of status 'error'.  Reason: Database Error in model int_user_first_step_ts (models/intermediate/int_user_first_step_ts.sql)
  Syntax error: Unexpected ";" at [15:14]
  compiled code at target/run/funnel_analysis/models/intermediate/int_user_first_step_ts.sql.
[0m17:10:36.737493 [debug] [Thread-3 (]: Began running node model.funnel_analysis.int_user_funnel_path
[0m17:10:36.737863 [info ] [Thread-3 (]: 3 of 6 SKIP relation analytics.int_user_funnel_path ............................ [[33mSKIP[0m]
[0m17:10:36.738180 [debug] [Thread-3 (]: Finished running node model.funnel_analysis.int_user_funnel_path
[0m17:10:36.738556 [debug] [Thread-2 (]: Began running node model.funnel_analysis.fct_funnel_conversions
[0m17:10:36.738809 [debug] [Thread-1 (]: Began running node model.funnel_analysis.fct_funnel_by_source
[0m17:10:36.739106 [info ] [Thread-2 (]: 6 of 6 SKIP relation analytics.fct_funnel_conversions .......................... [[33mSKIP[0m]
[0m17:10:36.739431 [debug] [Thread-4 (]: Began running node model.funnel_analysis.fct_funnel_by_cohort
[0m17:10:36.739694 [info ] [Thread-1 (]: 5 of 6 SKIP relation analytics.fct_funnel_by_source ............................ [[33mSKIP[0m]
[0m17:10:36.739979 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.fct_funnel_conversions
[0m17:10:36.740220 [info ] [Thread-4 (]: 4 of 6 SKIP relation analytics.fct_funnel_by_cohort ............................ [[33mSKIP[0m]
[0m17:10:36.740477 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.fct_funnel_by_source
[0m17:10:36.740753 [debug] [Thread-4 (]: Finished running node model.funnel_analysis.fct_funnel_by_cohort
[0m17:10:36.741478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:36.741860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:36.742042 [debug] [MainThread]: Connection 'model.funnel_analysis.stg_events' was properly closed.
[0m17:10:36.742207 [debug] [MainThread]: Connection 'model.funnel_analysis.int_user_first_step_ts' was properly closed.
[0m17:10:36.742432 [info ] [MainThread]: 
[0m17:10:36.742632 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m17:10:36.743202 [debug] [MainThread]: Command end result
[0m17:10:36.759850 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:10:36.761881 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:10:36.765828 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m17:10:36.766014 [info ] [MainThread]: 
[0m17:10:36.766199 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:10:36.766346 [info ] [MainThread]: 
[0m17:10:36.766543 [error] [MainThread]: [31mFailure in model int_user_first_step_ts (models/intermediate/int_user_first_step_ts.sql)[0m
[0m17:10:36.766717 [error] [MainThread]:   Database Error in model int_user_first_step_ts (models/intermediate/int_user_first_step_ts.sql)
  Syntax error: Unexpected ";" at [15:14]
  compiled code at target/run/funnel_analysis/models/intermediate/int_user_first_step_ts.sql
[0m17:10:36.766844 [info ] [MainThread]: 
[0m17:10:36.766999 [info ] [MainThread]:   compiled code at target/compiled/funnel_analysis/models/intermediate/int_user_first_step_ts.sql
[0m17:10:36.767124 [info ] [MainThread]: 
[0m17:10:36.767274 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=6
[0m17:10:36.770000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.777497, "process_in_blocks": "0", "process_kernel_time": 0.575214, "process_mem_max_rss": "353976320", "process_out_blocks": "0", "process_user_time": 3.421636}
[0m17:10:36.770354 [debug] [MainThread]: Command `dbt run` failed at 17:10:36.770270 after 3.78 seconds
[0m17:10:36.770613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156ef62b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156f222a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156651b50>]}
[0m17:10:36.770803 [debug] [MainThread]: Flushing usage events
[0m17:10:37.183046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:38.623655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061141a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c67890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c679d0>]}


============================== 17:10:38.626411 | 4a77e405-2ae9-4b7d-8635-93fdf1a30e1c ==============================
[0m17:10:38.626411 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:10:38.626729 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/barbaramariano/.dbt', 'target_path': 'None', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'debug': 'False', 'log_format': 'default', 'empty': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'quiet': 'False', 'log_cache_events': 'False'}
[0m17:10:40.073265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a77e405-2ae9-4b7d-8635-93fdf1a30e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106257bb0>]}
[0m17:10:40.099570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a77e405-2ae9-4b7d-8635-93fdf1a30e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15de65370>]}
[0m17:10:40.099861 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:10:40.259043 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:10:40.322364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:10:40.322568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:10:40.343503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a77e405-2ae9-4b7d-8635-93fdf1a30e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e37a250>]}
[0m17:10:40.378988 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:10:40.379893 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:10:40.397219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a77e405-2ae9-4b7d-8635-93fdf1a30e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e5c3980>]}
[0m17:10:40.397447 [info ] [MainThread]: Found 6 models, 1 seed, 5 data tests, 495 macros
[0m17:10:40.397612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a77e405-2ae9-4b7d-8635-93fdf1a30e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e54be70>]}
[0m17:10:40.398494 [info ] [MainThread]: 
[0m17:10:40.398673 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:10:40.398798 [info ] [MainThread]: 
[0m17:10:40.399024 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:10:40.400863 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408_analytics'
[0m17:10:40.401037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:41.063438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a77e405-2ae9-4b7d-8635-93fdf1a30e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e524d50>]}
[0m17:10:41.064280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:41.068169 [debug] [Thread-4 (]: Began running node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m17:10:41.068673 [debug] [Thread-2 (]: Began running node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m17:10:41.068990 [debug] [Thread-3 (]: Began running node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m17:10:41.069301 [debug] [Thread-1 (]: Began running node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m17:10:41.069632 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_events_user_id .................................. [RUN]
[0m17:10:41.070060 [info ] [Thread-2 (]: 2 of 5 START test not_null_int_user_funnel_path_user_id ........................ [RUN]
[0m17:10:41.070439 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_events_event_ts ................................. [RUN]
[0m17:10:41.070768 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment  [RUN]
[0m17:10:41.071231 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4'
[0m17:10:41.071659 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634'
[0m17:10:41.072023 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0'
[0m17:10:41.072310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2)
[0m17:10:41.072614 [debug] [Thread-4 (]: Began compiling node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m17:10:41.072872 [debug] [Thread-2 (]: Began compiling node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m17:10:41.073118 [debug] [Thread-3 (]: Began compiling node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m17:10:41.073373 [debug] [Thread-1 (]: Began compiling node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m17:10:41.087932 [debug] [Thread-4 (]: Writing injected SQL for node "test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4"
[0m17:10:41.090607 [debug] [Thread-2 (]: Writing injected SQL for node "test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634"
[0m17:10:41.093225 [debug] [Thread-3 (]: Writing injected SQL for node "test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0"
[0m17:10:41.097943 [debug] [Thread-1 (]: Writing injected SQL for node "test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2"
[0m17:10:41.098614 [debug] [Thread-2 (]: Began executing node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m17:10:41.098783 [debug] [Thread-3 (]: Began executing node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m17:10:41.098932 [debug] [Thread-1 (]: Began executing node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m17:10:41.099065 [debug] [Thread-4 (]: Began executing node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m17:10:41.109001 [debug] [Thread-2 (]: Writing runtime sql for node "test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634"
[0m17:10:41.109988 [debug] [Thread-3 (]: Writing runtime sql for node "test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0"
[0m17:10:41.110846 [debug] [Thread-1 (]: Writing runtime sql for node "test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2"
[0m17:10:41.111916 [debug] [Thread-4 (]: Writing runtime sql for node "test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4"
[0m17:10:41.112413 [debug] [Thread-2 (]: On test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:10:41.112627 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:10:41.112821 [debug] [Thread-3 (]: On test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from `funnel-analysis-473408`.`analytics`.`stg_events`
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m17:10:41.113484 [debug] [Thread-4 (]: On test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `funnel-analysis-473408`.`analytics`.`stg_events`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:10:41.113737 [debug] [Thread-1 (]: On test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_name as value_field,
        count(*) as n_records

    from `funnel-analysis-473408`.`analytics`.`stg_events`
    group by event_name

)

select *
from all_values
where value_field not in (
    'signup','profile_completed','kyc_passed','first_payment'
)



  
  
      
    ) dbt_internal_test
[0m17:10:41.113920 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:10:41.114153 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:10:41.114317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:41.699960 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:bf83db17-d65e-45b8-b707-aaa509f2e23a&page=queryresults
[0m17:10:41.790893 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:8ed475b7-bcc1-4aa4-837e-d6acd7608adf&page=queryresults
[0m17:10:41.791552 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:8ed475b7-bcc1-4aa4-837e-d6acd7608adf&page=queryresults
[0m17:10:41.804991 [debug] [Thread-2 (]: Database Error in test not_null_int_user_funnel_path_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.int_user_funnel_path was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/not_null_int_user_funnel_path_user_id.sql
[0m17:10:41.805470 [error] [Thread-2 (]: 2 of 5 ERROR not_null_int_user_funnel_path_user_id ............................. [[31mERROR[0m in 0.73s]
[0m17:10:41.806106 [debug] [Thread-2 (]: Finished running node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m17:10:41.806447 [debug] [Thread-2 (]: Began running node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m17:10:41.806829 [debug] [Thread-7 (]: Marking all children of 'test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634' to be skipped because of status 'error'.  Reason: Database Error in test not_null_int_user_funnel_path_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.int_user_funnel_path was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/not_null_int_user_funnel_path_user_id.sql.
[0m17:10:41.807124 [info ] [Thread-2 (]: 5 of 5 START test unique_int_user_funnel_path_user_id .......................... [RUN]
[0m17:10:41.808066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634, now test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6)
[0m17:10:41.808363 [debug] [Thread-2 (]: Began compiling node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m17:10:41.812932 [debug] [Thread-2 (]: Writing injected SQL for node "test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6"
[0m17:10:41.813433 [debug] [Thread-2 (]: Began executing node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m17:10:41.815215 [debug] [Thread-2 (]: Writing runtime sql for node "test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6"
[0m17:10:41.815656 [debug] [Thread-2 (]: On test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:10:41.815922 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:10:41.972436 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:edd17489-1a46-4875-b508-dfac270789dd&page=queryresults
[0m17:10:41.973347 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:edd17489-1a46-4875-b508-dfac270789dd&page=queryresults
[0m17:10:41.981669 [debug] [Thread-2 (]: Database Error in test unique_int_user_funnel_path_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.int_user_funnel_path was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/unique_int_user_funnel_path_user_id.sql
[0m17:10:41.982586 [error] [Thread-2 (]: 5 of 5 ERROR unique_int_user_funnel_path_user_id ............................... [[31mERROR[0m in 0.17s]
[0m17:10:41.987799 [debug] [Thread-2 (]: Finished running node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m17:10:41.991004 [debug] [Thread-7 (]: Marking all children of 'test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6' to be skipped because of status 'error'.  Reason: Database Error in test unique_int_user_funnel_path_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.int_user_funnel_path was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/unique_int_user_funnel_path_user_id.sql.
[0m17:10:41.990508 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_events_user_id ........................................ [[32mPASS[0m in 0.92s]
[0m17:10:41.991700 [debug] [Thread-4 (]: Finished running node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m17:10:42.131428 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:30197532-dda7-47ff-986c-64c974359419&page=queryresults
[0m17:10:42.165436 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:709a3101-47b5-4774-99cd-6b8b9b8a4865&page=queryresults
[0m17:10:42.321091 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_events_event_ts ....................................... [[32mPASS[0m in 1.25s]
[0m17:10:42.322585 [debug] [Thread-3 (]: Finished running node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m17:10:42.369972 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment  [[32mPASS[0m in 1.30s]
[0m17:10:42.371226 [debug] [Thread-1 (]: Finished running node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m17:10:42.373136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:42.373920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:42.374300 [debug] [MainThread]: Connection 'test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2' was properly closed.
[0m17:10:42.374607 [debug] [MainThread]: Connection 'test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4' was properly closed.
[0m17:10:42.374888 [debug] [MainThread]: Connection 'test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6' was properly closed.
[0m17:10:42.375172 [debug] [MainThread]: Connection 'test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0' was properly closed.
[0m17:10:42.375526 [info ] [MainThread]: 
[0m17:10:42.375888 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m17:10:42.377482 [debug] [MainThread]: Command end result
[0m17:10:42.405703 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:10:42.407553 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:10:42.412943 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m17:10:42.413165 [info ] [MainThread]: 
[0m17:10:42.413399 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:10:42.413593 [info ] [MainThread]: 
[0m17:10:42.413834 [error] [MainThread]: [31mFailure in test not_null_int_user_funnel_path_user_id (models/schema.yml)[0m
[0m17:10:42.414061 [error] [MainThread]:   Database Error in test not_null_int_user_funnel_path_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.int_user_funnel_path was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/not_null_int_user_funnel_path_user_id.sql
[0m17:10:42.414221 [info ] [MainThread]: 
[0m17:10:42.414413 [info ] [MainThread]:   compiled code at target/compiled/funnel_analysis/models/schema.yml/not_null_int_user_funnel_path_user_id.sql
[0m17:10:42.414578 [info ] [MainThread]: 
[0m17:10:42.414766 [error] [MainThread]: [31mFailure in test unique_int_user_funnel_path_user_id (models/schema.yml)[0m
[0m17:10:42.415040 [error] [MainThread]:   Database Error in test unique_int_user_funnel_path_user_id (models/schema.yml)
  Not found: Table funnel-analysis-473408:analytics.int_user_funnel_path was not found in location europe-west9
  compiled code at target/run/funnel_analysis/models/schema.yml/unique_int_user_funnel_path_user_id.sql
[0m17:10:42.415237 [info ] [MainThread]: 
[0m17:10:42.415420 [info ] [MainThread]:   compiled code at target/compiled/funnel_analysis/models/schema.yml/unique_int_user_funnel_path_user_id.sql
[0m17:10:42.415568 [info ] [MainThread]: 
[0m17:10:42.415738 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m17:10:42.417497 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.8236163, "process_in_blocks": "0", "process_kernel_time": 0.578286, "process_mem_max_rss": "351797248", "process_out_blocks": "0", "process_user_time": 3.359216}
[0m17:10:42.417793 [debug] [MainThread]: Command `dbt test` failed at 17:10:42.417741 after 3.82 seconds
[0m17:10:42.418043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e5db5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e5db750>]}
[0m17:10:42.418255 [debug] [MainThread]: Flushing usage events
[0m17:10:42.790524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:17.237919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043901a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e39d0>]}


============================== 17:12:17.241069 | 63613f20-655d-4eb4-a1f4-60acdda87700 ==============================
[0m17:12:17.241069 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:12:17.241379 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'log_format': 'default', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/barbaramariano/.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'use_colors': 'True', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'log_cache_events': 'False', 'no_print': 'None'}
[0m17:12:19.030226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63613f20-655d-4eb4-a1f4-60acdda87700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d7bb0>]}
[0m17:12:19.056393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63613f20-655d-4eb4-a1f4-60acdda87700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e16d370>]}
[0m17:12:19.056686 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:12:19.221159 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:12:19.287700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m17:12:19.288054 [debug] [MainThread]: Partial parsing: updated file: funnel_analysis://models/intermediate/int_user_first_step_ts.sql
[0m17:12:19.288307 [debug] [MainThread]: Partial parsing: updated file: funnel_analysis://models/marts/fct_funnel_by_source.sql
[0m17:12:19.288494 [debug] [MainThread]: Partial parsing: updated file: funnel_analysis://models/marts/fct_funnel_by_cohort.sql
[0m17:12:19.288659 [debug] [MainThread]: Partial parsing: updated file: funnel_analysis://models/marts/fct_funnel_conversions.sql
[0m17:12:19.288829 [debug] [MainThread]: Partial parsing: updated file: funnel_analysis://models/intermediate/int_user_funnel_path.sql
[0m17:12:19.470181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63613f20-655d-4eb4-a1f4-60acdda87700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e57bd50>]}
[0m17:12:19.512262 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:12:19.513766 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:12:19.528060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63613f20-655d-4eb4-a1f4-60acdda87700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e5f5d60>]}
[0m17:12:19.528320 [info ] [MainThread]: Found 6 models, 1 seed, 5 data tests, 495 macros
[0m17:12:19.528494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63613f20-655d-4eb4-a1f4-60acdda87700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e3c8130>]}
[0m17:12:19.529433 [info ] [MainThread]: 
[0m17:12:19.529600 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:12:19.529720 [info ] [MainThread]: 
[0m17:12:19.529945 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:12:19.531885 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m17:12:19.532089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:20.336936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m17:12:20.338691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:20.460460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63613f20-655d-4eb4-a1f4-60acdda87700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e7c0390>]}
[0m17:12:20.462418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:20.467821 [debug] [Thread-1 (]: Began running node model.funnel_analysis.stg_events
[0m17:12:20.468790 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_events ............................... [RUN]
[0m17:12:20.469413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now model.funnel_analysis.stg_events)
[0m17:12:20.469859 [debug] [Thread-1 (]: Began compiling node model.funnel_analysis.stg_events
[0m17:12:20.481061 [debug] [Thread-1 (]: Writing injected SQL for node "model.funnel_analysis.stg_events"
[0m17:12:20.482295 [debug] [Thread-1 (]: Began executing node model.funnel_analysis.stg_events
[0m17:12:20.506226 [debug] [Thread-1 (]: Writing runtime sql for node "model.funnel_analysis.stg_events"
[0m17:12:20.506987 [debug] [Thread-1 (]: On model.funnel_analysis.stg_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.stg_events"} */


  create or replace view `funnel-analysis-473408`.`analytics`.`stg_events`
  OPTIONS()
  as --clean & standardize the raw seed (analytics.events) so types/text are consistent.



with raw as (
  select
    cast(user_id as int64)                              as user_id,
    timestamp(event_time)                               as event_ts,
    lower(event_name)                                   as event_name,
    cast(step as int64)                                 as step,
    lower(source)                                       as source,
    upper(country)                                      as country
  from `funnel-analysis-473408`.`analytics`.`events`   -- the seeded CSV table
  where lower(event_name) in ('signup','profile_completed','kyc_passed','first_payment')
)
select * from raw;


[0m17:12:20.507278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:21.238339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:7f9de192-626a-451e-b37a-a93a2485a0af&page=queryresults
[0m17:12:21.429831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63613f20-655d-4eb4-a1f4-60acdda87700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15eb32090>]}
[0m17:12:21.430296 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_events .......................... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m17:12:21.430660 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.stg_events
[0m17:12:21.431174 [debug] [Thread-2 (]: Began running node model.funnel_analysis.int_user_first_step_ts
[0m17:12:21.431493 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.int_user_first_step_ts ................... [RUN]
[0m17:12:21.431777 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.funnel_analysis.int_user_first_step_ts'
[0m17:12:21.431959 [debug] [Thread-2 (]: Began compiling node model.funnel_analysis.int_user_first_step_ts
[0m17:12:21.433538 [debug] [Thread-2 (]: Writing injected SQL for node "model.funnel_analysis.int_user_first_step_ts"
[0m17:12:21.434342 [debug] [Thread-2 (]: Began executing node model.funnel_analysis.int_user_first_step_ts
[0m17:12:21.435973 [debug] [Thread-2 (]: Writing runtime sql for node "model.funnel_analysis.int_user_first_step_ts"
[0m17:12:21.436480 [debug] [Thread-2 (]: On model.funnel_analysis.int_user_first_step_ts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.int_user_first_step_ts"} */


  create or replace view `funnel-analysis-473408`.`analytics`.`int_user_first_step_ts`
  OPTIONS()
  as -- find the first time each user hit each funnel step



select
  user_id,
  event_name,
  min(event_ts) as first_ts
from `funnel-analysis-473408`.`analytics`.`stg_events`
group by 1,2;


[0m17:12:21.436695 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:12:22.467579 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:2e53d23d-48ff-4194-a503-47eab2232620&page=queryresults
[0m17:12:22.591391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63613f20-655d-4eb4-a1f4-60acdda87700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15eacf960>]}
[0m17:12:22.592145 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.int_user_first_step_ts .............. [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m17:12:22.592836 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.int_user_first_step_ts
[0m17:12:22.593337 [debug] [Thread-3 (]: Began running node model.funnel_analysis.int_user_funnel_path
[0m17:12:22.593738 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.int_user_funnel_path ..................... [RUN]
[0m17:12:22.594328 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.funnel_analysis.int_user_funnel_path'
[0m17:12:22.594592 [debug] [Thread-3 (]: Began compiling node model.funnel_analysis.int_user_funnel_path
[0m17:12:22.596737 [debug] [Thread-3 (]: Writing injected SQL for node "model.funnel_analysis.int_user_funnel_path"
[0m17:12:22.597171 [debug] [Thread-3 (]: Began executing node model.funnel_analysis.int_user_funnel_path
[0m17:12:22.598965 [debug] [Thread-3 (]: Writing runtime sql for node "model.funnel_analysis.int_user_funnel_path"
[0m17:12:22.599451 [debug] [Thread-3 (]: On model.funnel_analysis.int_user_funnel_path: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.int_user_funnel_path"} */


  create or replace view `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`
  OPTIONS()
  as -- reshape into one row per user with a timestamp column for each step.



with s as (select * from `funnel-analysis-473408`.`analytics`.`int_user_first_step_ts`)

select
  user_id,
  max(if(event_name='signup',            first_ts, null)) as ts_signup,
  max(if(event_name='profile_completed', first_ts, null)) as ts_profile_completed,
  max(if(event_name='kyc_passed',        first_ts, null)) as ts_kyc_passed,
  max(if(event_name='first_payment',     first_ts, null)) as ts_first_payment
from s
group by 1;


[0m17:12:22.599737 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:12:23.080241 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:1f47cfca-483c-435d-8c37-033e62ffa055&page=queryresults
[0m17:12:23.234157 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63613f20-655d-4eb4-a1f4-60acdda87700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15eff0550>]}
[0m17:12:23.235309 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.int_user_funnel_path ................ [[32mCREATE VIEW (0 processed)[0m in 0.64s]
[0m17:12:23.236103 [debug] [Thread-3 (]: Finished running node model.funnel_analysis.int_user_funnel_path
[0m17:12:23.237161 [debug] [Thread-4 (]: Began running node model.funnel_analysis.fct_funnel_by_cohort
[0m17:12:23.237719 [debug] [Thread-1 (]: Began running node model.funnel_analysis.fct_funnel_by_source
[0m17:12:23.238180 [debug] [Thread-2 (]: Began running node model.funnel_analysis.fct_funnel_conversions
[0m17:12:23.238759 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics.fct_funnel_by_cohort .................... [RUN]
[0m17:12:23.239495 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.fct_funnel_by_source .................... [RUN]
[0m17:12:23.240161 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics.fct_funnel_conversions .................. [RUN]
[0m17:12:23.240840 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.funnel_analysis.fct_funnel_by_cohort'
[0m17:12:23.241356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.funnel_analysis.stg_events, now model.funnel_analysis.fct_funnel_by_source)
[0m17:12:23.241811 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.funnel_analysis.int_user_first_step_ts, now model.funnel_analysis.fct_funnel_conversions)
[0m17:12:23.242169 [debug] [Thread-4 (]: Began compiling node model.funnel_analysis.fct_funnel_by_cohort
[0m17:12:23.242497 [debug] [Thread-1 (]: Began compiling node model.funnel_analysis.fct_funnel_by_source
[0m17:12:23.242812 [debug] [Thread-2 (]: Began compiling node model.funnel_analysis.fct_funnel_conversions
[0m17:12:23.246304 [debug] [Thread-4 (]: Writing injected SQL for node "model.funnel_analysis.fct_funnel_by_cohort"
[0m17:12:23.249261 [debug] [Thread-1 (]: Writing injected SQL for node "model.funnel_analysis.fct_funnel_by_source"
[0m17:12:23.252145 [debug] [Thread-2 (]: Writing injected SQL for node "model.funnel_analysis.fct_funnel_conversions"
[0m17:12:23.253186 [debug] [Thread-2 (]: Began executing node model.funnel_analysis.fct_funnel_conversions
[0m17:12:23.253538 [debug] [Thread-4 (]: Began executing node model.funnel_analysis.fct_funnel_by_cohort
[0m17:12:23.253826 [debug] [Thread-1 (]: Began executing node model.funnel_analysis.fct_funnel_by_source
[0m17:12:23.288198 [debug] [Thread-4 (]: Writing runtime sql for node "model.funnel_analysis.fct_funnel_by_cohort"
[0m17:12:23.289580 [debug] [Thread-1 (]: Writing runtime sql for node "model.funnel_analysis.fct_funnel_by_source"
[0m17:12:23.289854 [debug] [Thread-2 (]: Writing runtime sql for node "model.funnel_analysis.fct_funnel_conversions"
[0m17:12:23.290437 [debug] [Thread-2 (]: On model.funnel_analysis.fct_funnel_conversions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.fct_funnel_conversions"} */

  
    

    create or replace table `funnel-analysis-473408`.`analytics`.`fct_funnel_conversions`
      
    
    

    
    OPTIONS()
    as (
      -- overall counts and conversion rates from step to step and end-to-end.



with path as (select * from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`)

select
  countif(ts_signup is not null)            as n_signup,
  countif(ts_profile_completed is not null) as n_profile_completed,
  countif(ts_kyc_passed is not null)        as n_kyc_passed,
  countif(ts_first_payment is not null)     as n_first_payment,

  safe_divide(countif(ts_profile_completed is not null), countif(ts_signup is not null))          as cr_signup_to_profile,
  safe_divide(countif(ts_kyc_passed is not null),        countif(ts_profile_completed is not null)) as cr_profile_to_kyc,
  safe_divide(countif(ts_first_payment is not null),     countif(ts_kyc_passed is not null))        as cr_kyc_to_payment,
  safe_divide(countif(ts_first_payment is not null),     countif(ts_signup is not null))             as cr_signup_to_payment
from path
    );
  
[0m17:12:23.290722 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:12:23.290952 [debug] [Thread-4 (]: On model.funnel_analysis.fct_funnel_by_cohort: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.fct_funnel_by_cohort"} */

  
    

    create or replace table `funnel-analysis-473408`.`analytics`.`fct_funnel_by_cohort`
      
    
    

    
    OPTIONS()
    as (
      -- conversion by signup cohort (month of signup).



with e as (select * from `funnel-analysis-473408`.`analytics`.`stg_events`),

signup as (
  select user_id, min(event_ts) as signup_ts
  from e
  where event_name='signup'
  group by 1
),

path as (select * from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`),

joined as (
  select
    p.*,
    timestamp_trunc(s.signup_ts, month) as signup_month
  from path p
  left join signup s using (user_id)
)

select
  signup_month,
  countif(ts_signup is not null)            as n_signup,
  countif(ts_profile_completed is not null) as n_profile_completed,
  countif(ts_kyc_passed is not null)        as n_kyc_passed,
  countif(ts_first_payment is not null)     as n_first_payment
from joined
group by signup_month
order by signup_month
    );
  
[0m17:12:23.291226 [debug] [Thread-1 (]: On model.funnel_analysis.fct_funnel_by_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.fct_funnel_by_source"} */

  
    

    create or replace table `funnel-analysis-473408`.`analytics`.`fct_funnel_by_source`
      
    
    

    
    OPTIONS()
    as (
      -- conversion broken down by acquisition source (e.g., ads, organic, partner).



with e as (select * from `funnel-analysis-473408`.`analytics`.`stg_events`),

firsts as (
  select user_id, min(event_ts) as signup_ts
  from e
  where event_name='signup'
  group by 1
),

source_at_signup as (
  -- source captured at the signup moment
  select f.user_id, any_value(e.source) as source
  from firsts f
  join e using (user_id)
  where e.event_name='signup' and e.event_ts = f.signup_ts
  group by f.user_id
),

path as (select * from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`),

joined as (
  select p.*, s.source
  from path p
  left join source_at_signup s using (user_id)
)

select
  source,
  countif(ts_signup is not null)            as n_signup,
  countif(ts_profile_completed is not null) as n_profile_completed,
  countif(ts_kyc_passed is not null)        as n_kyc_passed,
  countif(ts_first_payment is not null)     as n_first_payment,

  safe_divide(countif(ts_profile_completed is not null), countif(ts_signup is not null))            as cr_signup_to_profile,
  safe_divide(countif(ts_kyc_passed is not null),        countif(ts_profile_completed is not null)) as cr_profile_to_kyc,
  safe_divide(countif(ts_first_payment is not null),     countif(ts_kyc_passed is not null))        as cr_kyc_to_payment,
  safe_divide(countif(ts_first_payment is not null),     countif(ts_signup is not null))             as cr_signup_to_payment
from joined
group by source
order by source
    );
  
[0m17:12:23.291884 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:12:23.292065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:23.794941 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:8a205b85-f459-4cf3-970e-8fc5cec65c52&page=queryresults
[0m17:12:23.805809 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:a2e26d99-710a-4e4a-bfea-2ae06e76fec3&page=queryresults
[0m17:12:23.811319 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:4ddeb068-952c-4756-9b5f-54930489a921&page=queryresults
[0m17:12:25.163283 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63613f20-655d-4eb4-a1f4-60acdda87700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15efa0450>]}
[0m17:12:25.164739 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics.fct_funnel_conversions ............. [[32mCREATE TABLE (1.0 rows, 264.0 Bytes processed)[0m in 1.92s]
[0m17:12:25.165564 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.fct_funnel_conversions
[0m17:12:25.384474 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63613f20-655d-4eb4-a1f4-60acdda87700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f8ee4a0>]}
[0m17:12:25.386442 [info ] [Thread-4 (]: 4 of 6 OK created sql table model analytics.fct_funnel_by_cohort ............... [[32mCREATE TABLE (1.0 rows, 264.0 Bytes processed)[0m in 2.14s]
[0m17:12:25.389259 [debug] [Thread-4 (]: Finished running node model.funnel_analysis.fct_funnel_by_cohort
[0m17:12:25.392262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63613f20-655d-4eb4-a1f4-60acdda87700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f912030>]}
[0m17:12:25.393284 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.fct_funnel_by_source ............... [[32mCREATE TABLE (3.0 rows, 329.0 Bytes processed)[0m in 2.15s]
[0m17:12:25.394002 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.fct_funnel_by_source
[0m17:12:25.395440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:25.396073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:25.396376 [debug] [MainThread]: Connection 'model.funnel_analysis.fct_funnel_by_source' was properly closed.
[0m17:12:25.396623 [debug] [MainThread]: Connection 'model.funnel_analysis.fct_funnel_conversions' was properly closed.
[0m17:12:25.396858 [debug] [MainThread]: Connection 'model.funnel_analysis.int_user_funnel_path' was properly closed.
[0m17:12:25.397096 [debug] [MainThread]: Connection 'model.funnel_analysis.fct_funnel_by_cohort' was properly closed.
[0m17:12:25.397479 [info ] [MainThread]: 
[0m17:12:25.397808 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m17:12:25.399172 [debug] [MainThread]: Command end result
[0m17:12:25.424049 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:12:25.425917 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:12:25.430319 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m17:12:25.430534 [info ] [MainThread]: 
[0m17:12:25.430760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:25.430930 [info ] [MainThread]: 
[0m17:12:25.431107 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m17:12:25.432981 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.229727, "process_in_blocks": "0", "process_kernel_time": 0.590733, "process_mem_max_rss": "351387648", "process_out_blocks": "0", "process_user_time": 3.864486}
[0m17:12:25.433335 [debug] [MainThread]: Command `dbt run` succeeded at 17:12:25.433284 after 8.23 seconds
[0m17:12:25.433584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e78ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f911790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f911910>]}
[0m17:12:25.433770 [debug] [MainThread]: Flushing usage events
[0m17:12:25.979643 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:27.401897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100141a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a67890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a679d0>]}


============================== 17:12:27.404673 | 533f1dbe-e082-4dcf-8dda-7ebd9caf7cb7 ==============================
[0m17:12:27.404673 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:12:27.404970 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'profiles_dir': '/Users/barbaramariano/.dbt', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'use_colors': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'warn_error': 'None'}
[0m17:12:28.793678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '533f1dbe-e082-4dcf-8dda-7ebd9caf7cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110157bb0>]}
[0m17:12:28.820205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '533f1dbe-e082-4dcf-8dda-7ebd9caf7cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fa65370>]}
[0m17:12:28.820492 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:12:28.992271 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:12:29.054896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:12:29.055090 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:12:29.075945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '533f1dbe-e082-4dcf-8dda-7ebd9caf7cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ff7a250>]}
[0m17:12:29.111300 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:12:29.112227 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:12:29.129871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '533f1dbe-e082-4dcf-8dda-7ebd9caf7cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1602b7980>]}
[0m17:12:29.130117 [info ] [MainThread]: Found 6 models, 1 seed, 5 data tests, 495 macros
[0m17:12:29.130281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '533f1dbe-e082-4dcf-8dda-7ebd9caf7cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16024be70>]}
[0m17:12:29.131192 [info ] [MainThread]: 
[0m17:12:29.131366 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:12:29.131483 [info ] [MainThread]: 
[0m17:12:29.131699 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:12:29.133576 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408_analytics'
[0m17:12:29.133751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:29.781696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '533f1dbe-e082-4dcf-8dda-7ebd9caf7cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160228d50>]}
[0m17:12:29.782283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:29.785007 [debug] [Thread-3 (]: Began running node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m17:12:29.785403 [debug] [Thread-2 (]: Began running node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m17:12:29.785696 [debug] [Thread-4 (]: Began running node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m17:12:29.785968 [debug] [Thread-1 (]: Began running node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m17:12:29.786276 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_events_event_ts ................................. [RUN]
[0m17:12:29.786626 [info ] [Thread-2 (]: 2 of 5 START test not_null_int_user_funnel_path_user_id ........................ [RUN]
[0m17:12:29.786988 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_events_user_id .................................. [RUN]
[0m17:12:29.787260 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment  [RUN]
[0m17:12:29.787663 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0'
[0m17:12:29.787998 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634'
[0m17:12:29.788316 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4'
[0m17:12:29.788575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2)
[0m17:12:29.788842 [debug] [Thread-3 (]: Began compiling node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m17:12:29.789075 [debug] [Thread-2 (]: Began compiling node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m17:12:29.789294 [debug] [Thread-4 (]: Began compiling node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m17:12:29.789515 [debug] [Thread-1 (]: Began compiling node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m17:12:29.804225 [debug] [Thread-3 (]: Writing injected SQL for node "test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0"
[0m17:12:29.806497 [debug] [Thread-2 (]: Writing injected SQL for node "test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634"
[0m17:12:29.808271 [debug] [Thread-4 (]: Writing injected SQL for node "test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4"
[0m17:12:29.812358 [debug] [Thread-1 (]: Writing injected SQL for node "test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2"
[0m17:12:29.812975 [debug] [Thread-2 (]: Began executing node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m17:12:29.813151 [debug] [Thread-3 (]: Began executing node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m17:12:29.813296 [debug] [Thread-4 (]: Began executing node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m17:12:29.823208 [debug] [Thread-2 (]: Writing runtime sql for node "test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634"
[0m17:12:29.824143 [debug] [Thread-3 (]: Writing runtime sql for node "test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0"
[0m17:12:29.824311 [debug] [Thread-1 (]: Began executing node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m17:12:29.825240 [debug] [Thread-4 (]: Writing runtime sql for node "test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4"
[0m17:12:29.826428 [debug] [Thread-1 (]: Writing runtime sql for node "test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2"
[0m17:12:29.826754 [debug] [Thread-2 (]: On test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:12:29.826968 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:12:29.827442 [debug] [Thread-3 (]: On test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from `funnel-analysis-473408`.`analytics`.`stg_events`
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m17:12:29.827763 [debug] [Thread-4 (]: On test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `funnel-analysis-473408`.`analytics`.`stg_events`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:12:29.827935 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:12:29.828127 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:12:29.828305 [debug] [Thread-1 (]: On test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_name as value_field,
        count(*) as n_records

    from `funnel-analysis-473408`.`analytics`.`stg_events`
    group by event_name

)

select *
from all_values
where value_field not in (
    'signup','profile_completed','kyc_passed','first_payment'
)



  
  
      
    ) dbt_internal_test
[0m17:12:29.829114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:30.453700 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:da9d4b50-05a3-4f4b-a0eb-3311af6e02f1&page=queryresults
[0m17:12:30.455513 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:ce6c97f6-2ef0-4dea-a8a2-8c22cedfaff4&page=queryresults
[0m17:12:30.457538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:b49e1fc2-d15c-420e-b967-12f613b9437c&page=queryresults
[0m17:12:30.460253 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:b554f810-1839-45b9-922a-fe9ae5e4129e&page=queryresults
[0m17:12:30.693370 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment  [[32mPASS[0m in 0.90s]
[0m17:12:30.694690 [debug] [Thread-1 (]: Finished running node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m17:12:30.696737 [info ] [Thread-2 (]: 2 of 5 PASS not_null_int_user_funnel_path_user_id .............................. [[32mPASS[0m in 0.91s]
[0m17:12:30.697286 [debug] [Thread-1 (]: Began running node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m17:12:30.697926 [debug] [Thread-2 (]: Finished running node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m17:12:30.698291 [info ] [Thread-1 (]: 5 of 5 START test unique_int_user_funnel_path_user_id .......................... [RUN]
[0m17:12:30.698876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2, now test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6)
[0m17:12:30.699316 [debug] [Thread-1 (]: Began compiling node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m17:12:30.705742 [debug] [Thread-1 (]: Writing injected SQL for node "test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6"
[0m17:12:30.708096 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_events_event_ts ....................................... [[32mPASS[0m in 0.92s]
[0m17:12:30.708545 [debug] [Thread-3 (]: Finished running node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m17:12:30.708816 [debug] [Thread-1 (]: Began executing node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m17:12:30.710476 [debug] [Thread-1 (]: Writing runtime sql for node "test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6"
[0m17:12:30.710964 [debug] [Thread-1 (]: On test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:12:30.711260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:30.715349 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_events_user_id ........................................ [[32mPASS[0m in 0.93s]
[0m17:12:30.715785 [debug] [Thread-4 (]: Finished running node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m17:12:31.679124 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:5ee39965-4c4c-4544-9bd7-1be184599f9d&page=queryresults
[0m17:12:31.926745 [info ] [Thread-1 (]: 5 of 5 PASS unique_int_user_funnel_path_user_id ................................ [[32mPASS[0m in 1.23s]
[0m17:12:31.928246 [debug] [Thread-1 (]: Finished running node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m17:12:31.944231 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:31.944817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:31.945053 [debug] [MainThread]: Connection 'test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6' was properly closed.
[0m17:12:31.945216 [debug] [MainThread]: Connection 'test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0' was properly closed.
[0m17:12:31.945358 [debug] [MainThread]: Connection 'test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634' was properly closed.
[0m17:12:31.945497 [debug] [MainThread]: Connection 'test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4' was properly closed.
[0m17:12:31.945687 [info ] [MainThread]: 
[0m17:12:31.945877 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m17:12:31.946797 [debug] [MainThread]: Command end result
[0m17:12:31.967233 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:12:31.970206 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:12:31.977726 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m17:12:31.978019 [info ] [MainThread]: 
[0m17:12:31.978304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:31.978515 [info ] [MainThread]: 
[0m17:12:31.978738 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m17:12:31.980536 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.6107645, "process_in_blocks": "0", "process_kernel_time": 0.540166, "process_mem_max_rss": "337297408", "process_out_blocks": "0", "process_user_time": 3.424822}
[0m17:12:31.980903 [debug] [MainThread]: Command `dbt test` succeeded at 17:12:31.980837 after 4.61 seconds
[0m17:12:31.981180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118a5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1602db3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1602db750>]}
[0m17:12:31.981426 [debug] [MainThread]: Flushing usage events
[0m17:12:32.364989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:18.594048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103af01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104943890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049439d0>]}


============================== 17:14:18.597333 | db6e738e-c144-4e7e-aa3b-3d5528f52740 ==============================
[0m17:14:18.597333 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:14:18.597649 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'printer_width': '80', 'version_check': 'True', 'write_json': 'True', 'profiles_dir': '/Users/barbaramariano/.dbt', 'static_parser': 'True', 'debug': 'False', 'use_colors': 'True', 'log_cache_events': 'False'}
[0m17:14:20.377862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db6e738e-c144-4e7e-aa3b-3d5528f52740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c37bb0>]}
[0m17:14:20.404745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db6e738e-c144-4e7e-aa3b-3d5528f52740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d865370>]}
[0m17:14:20.405082 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:14:20.605244 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:14:20.673992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:20.674212 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:20.695346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db6e738e-c144-4e7e-aa3b-3d5528f52740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dc7a250>]}
[0m17:14:20.731971 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:14:20.733604 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:14:20.754179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db6e738e-c144-4e7e-aa3b-3d5528f52740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dfb7980>]}
[0m17:14:20.754437 [info ] [MainThread]: Found 6 models, 1 seed, 5 data tests, 495 macros
[0m17:14:20.754600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db6e738e-c144-4e7e-aa3b-3d5528f52740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15df4be70>]}
[0m17:14:20.755545 [info ] [MainThread]: 
[0m17:14:20.755714 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:14:20.755832 [info ] [MainThread]: 
[0m17:14:20.756057 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:14:20.757942 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408_analytics'
[0m17:14:20.758119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:21.551182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db6e738e-c144-4e7e-aa3b-3d5528f52740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15df28d50>]}
[0m17:14:21.552813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:21.556041 [debug] [Thread-1 (]: Began running node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m17:14:21.556483 [debug] [Thread-2 (]: Began running node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m17:14:21.556902 [debug] [Thread-4 (]: Began running node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m17:14:21.557253 [debug] [Thread-3 (]: Began running node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m17:14:21.557651 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment  [RUN]
[0m17:14:21.558137 [info ] [Thread-2 (]: 2 of 5 START test not_null_int_user_funnel_path_user_id ........................ [RUN]
[0m17:14:21.558641 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_events_user_id .................................. [RUN]
[0m17:14:21.559163 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_events_event_ts ................................. [RUN]
[0m17:14:21.559597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2)
[0m17:14:21.560024 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634'
[0m17:14:21.560380 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4'
[0m17:14:21.560729 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0'
[0m17:14:21.561033 [debug] [Thread-1 (]: Began compiling node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m17:14:21.561419 [debug] [Thread-2 (]: Began compiling node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m17:14:21.561708 [debug] [Thread-4 (]: Began compiling node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m17:14:21.561992 [debug] [Thread-3 (]: Began compiling node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m17:14:21.583043 [debug] [Thread-2 (]: Writing injected SQL for node "test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634"
[0m17:14:21.586218 [debug] [Thread-1 (]: Writing injected SQL for node "test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2"
[0m17:14:21.588309 [debug] [Thread-4 (]: Writing injected SQL for node "test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4"
[0m17:14:21.589896 [debug] [Thread-3 (]: Writing injected SQL for node "test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0"
[0m17:14:21.590411 [debug] [Thread-1 (]: Began executing node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m17:14:21.590581 [debug] [Thread-4 (]: Began executing node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m17:14:21.590738 [debug] [Thread-2 (]: Began executing node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m17:14:21.590876 [debug] [Thread-3 (]: Began executing node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m17:14:21.600613 [debug] [Thread-1 (]: Writing runtime sql for node "test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2"
[0m17:14:21.601556 [debug] [Thread-4 (]: Writing runtime sql for node "test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4"
[0m17:14:21.602416 [debug] [Thread-2 (]: Writing runtime sql for node "test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634"
[0m17:14:21.603456 [debug] [Thread-3 (]: Writing runtime sql for node "test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0"
[0m17:14:21.603978 [debug] [Thread-1 (]: On test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_name as value_field,
        count(*) as n_records

    from `funnel-analysis-473408`.`analytics`.`stg_events`
    group by event_name

)

select *
from all_values
where value_field not in (
    'signup','profile_completed','kyc_passed','first_payment'
)



  
  
      
    ) dbt_internal_test
[0m17:14:21.604200 [debug] [Thread-2 (]: On test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:14:21.604395 [debug] [Thread-4 (]: On test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `funnel-analysis-473408`.`analytics`.`stg_events`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:14:21.604590 [debug] [Thread-3 (]: On test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from `funnel-analysis-473408`.`analytics`.`stg_events`
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m17:14:21.604757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:21.604895 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:14:21.605053 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:14:21.605186 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:14:22.210547 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:b8dd7332-ac73-43fc-8409-cd2da09fd663&page=queryresults
[0m17:14:22.212305 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:348a025c-f45d-4689-ac9f-dcc4778916e3&page=queryresults
[0m17:14:22.214159 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:6eda1b2a-1f99-4cbf-8454-9129dee1bbcb&page=queryresults
[0m17:14:22.214855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:19066885-032d-48ff-b6b0-54b6a3abd016&page=queryresults
[0m17:14:22.497079 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_events_event_ts ....................................... [[32mPASS[0m in 0.94s]
[0m17:14:22.498341 [debug] [Thread-3 (]: Finished running node test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0
[0m17:14:22.498732 [debug] [Thread-3 (]: Began running node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m17:14:22.498968 [info ] [Thread-3 (]: 5 of 5 START test unique_int_user_funnel_path_user_id .......................... [RUN]
[0m17:14:22.499214 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.funnel_analysis.not_null_stg_events_event_ts.085d2fcee0, now test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6)
[0m17:14:22.508504 [info ] [Thread-2 (]: 2 of 5 PASS not_null_int_user_funnel_path_user_id .............................. [[32mPASS[0m in 0.95s]
[0m17:14:22.509179 [debug] [Thread-3 (]: Began compiling node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m17:14:22.508986 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment  [[32mPASS[0m in 0.95s]
[0m17:14:22.516504 [debug] [Thread-1 (]: Finished running node test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2
[0m17:14:22.510889 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_events_user_id ........................................ [[32mPASS[0m in 0.95s]
[0m17:14:22.517242 [debug] [Thread-4 (]: Finished running node test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4
[0m17:14:22.515951 [debug] [Thread-3 (]: Writing injected SQL for node "test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6"
[0m17:14:22.511304 [debug] [Thread-2 (]: Finished running node test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634
[0m17:14:22.518994 [debug] [Thread-3 (]: Began executing node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m17:14:22.523837 [debug] [Thread-3 (]: Writing runtime sql for node "test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6"
[0m17:14:22.527521 [debug] [Thread-3 (]: On test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:14:22.528045 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:14:23.503825 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:3c304c4c-ef26-4e53-afd0-7f1082bb5f0d&page=queryresults
[0m17:14:23.673168 [info ] [Thread-3 (]: 5 of 5 PASS unique_int_user_funnel_path_user_id ................................ [[32mPASS[0m in 1.17s]
[0m17:14:23.675217 [debug] [Thread-3 (]: Finished running node test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6
[0m17:14:23.694257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:23.696056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:23.696902 [debug] [MainThread]: Connection 'test.funnel_analysis.accepted_values_stg_events_event_name__signup__profile_completed__kyc_passed__first_payment.dcb92d9fe2' was properly closed.
[0m17:14:23.697106 [debug] [MainThread]: Connection 'test.funnel_analysis.not_null_int_user_funnel_path_user_id.2cec599634' was properly closed.
[0m17:14:23.697252 [debug] [MainThread]: Connection 'test.funnel_analysis.not_null_stg_events_user_id.63ec98fbc4' was properly closed.
[0m17:14:23.697384 [debug] [MainThread]: Connection 'test.funnel_analysis.unique_int_user_funnel_path_user_id.872d2b13f6' was properly closed.
[0m17:14:23.697603 [info ] [MainThread]: 
[0m17:14:23.697791 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m17:14:23.698500 [debug] [MainThread]: Command end result
[0m17:14:23.721709 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:14:23.723887 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:14:23.731149 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m17:14:23.731410 [info ] [MainThread]: 
[0m17:14:23.731715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:23.731977 [info ] [MainThread]: 
[0m17:14:23.732224 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m17:14:23.736008 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.179617, "process_in_blocks": "0", "process_kernel_time": 0.636678, "process_mem_max_rss": "345522176", "process_out_blocks": "0", "process_user_time": 3.579188}
[0m17:14:23.736406 [debug] [MainThread]: Command `dbt test` succeeded at 17:14:23.736335 after 5.18 seconds
[0m17:14:23.736881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104781e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dfdb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dfdac50>]}
[0m17:14:23.737459 [debug] [MainThread]: Flushing usage events
[0m17:14:24.173839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:06.981411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070141a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110963890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109639d0>]}


============================== 17:15:06.985714 | ebb3a702-34ee-4719-a561-ebfe48ca4147 ==============================
[0m17:15:06.985714 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:15:06.986043 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'target_path': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'empty': 'False', 'version_check': 'True', 'log_format': 'default', 'profiles_dir': '/Users/barbaramariano/.dbt', 'debug': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt build -s fct_funnel_conversions', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'cache_selected_only': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None'}
[0m17:15:08.697325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebb3a702-34ee-4719-a561-ebfe48ca4147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715bbb0>]}
[0m17:15:08.723469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebb3a702-34ee-4719-a561-ebfe48ca4147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160d6d370>]}
[0m17:15:08.723767 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:15:08.892222 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:15:08.958749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:08.958937 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:08.979621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebb3a702-34ee-4719-a561-ebfe48ca4147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16127a950>]}
[0m17:15:09.015652 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:15:09.016817 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:15:09.037228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebb3a702-34ee-4719-a561-ebfe48ca4147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1615f2210>]}
[0m17:15:09.037497 [info ] [MainThread]: Found 6 models, 1 seed, 5 data tests, 495 macros
[0m17:15:09.038378 [info ] [MainThread]: 
[0m17:15:09.038564 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:15:09.038690 [info ] [MainThread]: 
[0m17:15:09.038918 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:15:09.039312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m17:15:09.039491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:09.833516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m17:15:09.833886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:10.014145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebb3a702-34ee-4719-a561-ebfe48ca4147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161619ef0>]}
[0m17:15:10.015731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:10.021093 [debug] [Thread-1 (]: Began running node model.funnel_analysis.fct_funnel_conversions
[0m17:15:10.021752 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.fct_funnel_conversions .................. [RUN]
[0m17:15:10.022257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now model.funnel_analysis.fct_funnel_conversions)
[0m17:15:10.022629 [debug] [Thread-1 (]: Began compiling node model.funnel_analysis.fct_funnel_conversions
[0m17:15:10.034152 [debug] [Thread-1 (]: Writing injected SQL for node "model.funnel_analysis.fct_funnel_conversions"
[0m17:15:10.035923 [debug] [Thread-1 (]: Began executing node model.funnel_analysis.fct_funnel_conversions
[0m17:15:10.047246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:10.192434 [debug] [Thread-1 (]: Writing runtime sql for node "model.funnel_analysis.fct_funnel_conversions"
[0m17:15:10.193155 [debug] [Thread-1 (]: On model.funnel_analysis.fct_funnel_conversions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.fct_funnel_conversions"} */

  
    

    create or replace table `funnel-analysis-473408`.`analytics`.`fct_funnel_conversions`
      
    
    

    
    OPTIONS()
    as (
      -- overall counts and conversion rates from step to step and end-to-end.



with path as (select * from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`)

select
  countif(ts_signup is not null)            as n_signup,
  countif(ts_profile_completed is not null) as n_profile_completed,
  countif(ts_kyc_passed is not null)        as n_kyc_passed,
  countif(ts_first_payment is not null)     as n_first_payment,

  safe_divide(countif(ts_profile_completed is not null), countif(ts_signup is not null))          as cr_signup_to_profile,
  safe_divide(countif(ts_kyc_passed is not null),        countif(ts_profile_completed is not null)) as cr_profile_to_kyc,
  safe_divide(countif(ts_first_payment is not null),     countif(ts_kyc_passed is not null))        as cr_kyc_to_payment,
  safe_divide(countif(ts_first_payment is not null),     countif(ts_signup is not null))             as cr_signup_to_payment
from path
    );
  
[0m17:15:10.811612 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:a53ca750-78df-4044-8f63-88715d6dabef&page=queryresults
[0m17:15:12.235606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb3a702-34ee-4719-a561-ebfe48ca4147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16197bd40>]}
[0m17:15:12.236267 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.fct_funnel_conversions ............. [[32mCREATE TABLE (1.0 rows, 264.0 Bytes processed)[0m in 2.21s]
[0m17:15:12.236611 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.fct_funnel_conversions
[0m17:15:12.237495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:12.237858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:12.238012 [debug] [MainThread]: Connection 'model.funnel_analysis.fct_funnel_conversions' was properly closed.
[0m17:15:12.238183 [info ] [MainThread]: 
[0m17:15:12.238343 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m17:15:12.238697 [debug] [MainThread]: Command end result
[0m17:15:12.251768 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:15:12.253367 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:15:12.256526 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m17:15:12.256684 [info ] [MainThread]: 
[0m17:15:12.256881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:12.257011 [info ] [MainThread]: 
[0m17:15:12.257169 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:15:12.258972 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.3163075, "process_in_blocks": "0", "process_kernel_time": 0.57513, "process_mem_max_rss": "344801280", "process_out_blocks": "0", "process_user_time": 3.454941}
[0m17:15:12.259291 [debug] [MainThread]: Command `dbt build` succeeded at 17:15:12.259240 after 5.32 seconds
[0m17:15:12.259509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1619e8730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1619e89f0>]}
[0m17:15:12.259673 [debug] [MainThread]: Flushing usage events
[0m17:15:12.640285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:34:05.453395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d841a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd79d0>]}


============================== 17:34:05.456342 | fbfffd65-1266-4510-9f35-6269960147c0 ==============================
[0m17:34:05.456342 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:34:05.456655 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'invocation_command': 'dbt seed', 'profiles_dir': '/Users/barbaramariano/.dbt', 'no_print': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'write_json': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True', 'quiet': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'warn_error': 'None', 'empty': 'None', 'cache_selected_only': 'False'}
[0m17:34:07.265050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbfffd65-1266-4510-9f35-6269960147c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecbbb0>]}
[0m17:34:07.290750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbfffd65-1266-4510-9f35-6269960147c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161b6d370>]}
[0m17:34:07.291044 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:34:07.479388 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:34:07.547284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:34:07.547699 [debug] [MainThread]: Partial parsing: updated file: funnel_analysis://seeds/events.csv
[0m17:34:07.645150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbfffd65-1266-4510-9f35-6269960147c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161f7ae50>]}
[0m17:34:07.680183 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:34:07.681869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:34:07.694112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbfffd65-1266-4510-9f35-6269960147c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161ff1c70>]}
[0m17:34:07.694338 [info ] [MainThread]: Found 6 models, 5 data tests, 1 seed, 495 macros
[0m17:34:07.694500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbfffd65-1266-4510-9f35-6269960147c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161bcb930>]}
[0m17:34:07.695353 [info ] [MainThread]: 
[0m17:34:07.695520 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:34:07.695642 [info ] [MainThread]: 
[0m17:34:07.695851 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:34:07.696235 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m17:34:07.696417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:09.147404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m17:34:09.148180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:09.319779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbfffd65-1266-4510-9f35-6269960147c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16292f930>]}
[0m17:34:09.321164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:09.327149 [debug] [Thread-1 (]: Began running node seed.funnel_analysis.events
[0m17:34:09.327978 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.events ........................................ [RUN]
[0m17:34:09.328618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now seed.funnel_analysis.events)
[0m17:34:09.329070 [debug] [Thread-1 (]: Began compiling node seed.funnel_analysis.events
[0m17:34:09.329489 [debug] [Thread-1 (]: Began executing node seed.funnel_analysis.events
[0m17:34:09.388403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:12.297181 [debug] [Thread-1 (]: On seed.funnel_analysis.events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "seed.funnel_analysis.events"} */

    alter table `funnel-analysis-473408`.`analytics`.`events` set OPTIONS()
  
[0m17:34:12.483074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:d10fbf04-c2f7-4216-ac20-61284e65e527&page=queryresults
[0m17:34:12.694159 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.funnel_analysis.events"
[0m17:34:12.718726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbfffd65-1266-4510-9f35-6269960147c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162ab6b10>]}
[0m17:34:12.719318 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics.events .................................... [[32mINSERT 2920[0m in 3.39s]
[0m17:34:12.719826 [debug] [Thread-1 (]: Finished running node seed.funnel_analysis.events
[0m17:34:12.721105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:34:12.721622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:12.721826 [debug] [MainThread]: Connection 'seed.funnel_analysis.events' was properly closed.
[0m17:34:12.722042 [info ] [MainThread]: 
[0m17:34:12.722266 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m17:34:12.722773 [debug] [MainThread]: Command end result
[0m17:34:12.739679 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:34:12.741775 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:34:12.745422 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m17:34:12.745613 [info ] [MainThread]: 
[0m17:34:12.745841 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:34:12.746002 [info ] [MainThread]: 
[0m17:34:12.746196 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:34:12.770946 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.3525944, "process_in_blocks": "0", "process_kernel_time": 0.609804, "process_mem_max_rss": "360513536", "process_out_blocks": "0", "process_user_time": 3.578431}
[0m17:34:12.771598 [debug] [MainThread]: Command `dbt seed` succeeded at 17:34:12.771500 after 7.35 seconds
[0m17:34:12.771985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162976d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162ab0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162ab07d0>]}
[0m17:34:12.772192 [debug] [MainThread]: Flushing usage events
[0m17:34:13.212488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:34:14.800111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103141a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111563890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115639d0>]}


============================== 17:34:14.802834 | 465b5275-d355-4bbc-aa10-8c807938dc54 ==============================
[0m17:34:14.802834 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:34:14.803143 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'use_experimental_parser': 'False', 'log_format': 'default', 'target_path': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'empty': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'no_print': 'None', 'fail_fast': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'profiles_dir': '/Users/barbaramariano/.dbt', 'write_json': 'True'}
[0m17:34:16.214187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '465b5275-d355-4bbc-aa10-8c807938dc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110457bb0>]}
[0m17:34:16.241003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '465b5275-d355-4bbc-aa10-8c807938dc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161d65370>]}
[0m17:34:16.241335 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:34:16.404058 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:34:16.467175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:34:16.467364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:34:16.487923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '465b5275-d355-4bbc-aa10-8c807938dc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16227a650>]}
[0m17:34:16.524355 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:34:16.525234 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:34:16.537255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '465b5275-d355-4bbc-aa10-8c807938dc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161dc3d40>]}
[0m17:34:16.537481 [info ] [MainThread]: Found 6 models, 5 data tests, 1 seed, 495 macros
[0m17:34:16.537646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '465b5275-d355-4bbc-aa10-8c807938dc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161e220b0>]}
[0m17:34:16.538517 [info ] [MainThread]: 
[0m17:34:16.538689 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:34:16.538811 [info ] [MainThread]: 
[0m17:34:16.539031 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:34:16.540864 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m17:34:16.541040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:17.310113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m17:34:17.311204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:17.456263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '465b5275-d355-4bbc-aa10-8c807938dc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162528d50>]}
[0m17:34:17.457537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:17.463883 [debug] [Thread-1 (]: Began running node model.funnel_analysis.stg_events
[0m17:34:17.464675 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_events ............................... [RUN]
[0m17:34:17.465301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now model.funnel_analysis.stg_events)
[0m17:34:17.465753 [debug] [Thread-1 (]: Began compiling node model.funnel_analysis.stg_events
[0m17:34:17.479089 [debug] [Thread-1 (]: Writing injected SQL for node "model.funnel_analysis.stg_events"
[0m17:34:17.479847 [debug] [Thread-1 (]: Began executing node model.funnel_analysis.stg_events
[0m17:34:17.502784 [debug] [Thread-1 (]: Writing runtime sql for node "model.funnel_analysis.stg_events"
[0m17:34:17.503330 [debug] [Thread-1 (]: On model.funnel_analysis.stg_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.stg_events"} */


  create or replace view `funnel-analysis-473408`.`analytics`.`stg_events`
  OPTIONS()
  as --clean & standardize the raw seed (analytics.events) so types/text are consistent.



with raw as (
  select
    cast(user_id as int64)                              as user_id,
    timestamp(event_time)                               as event_ts,
    lower(event_name)                                   as event_name,
    cast(step as int64)                                 as step,
    lower(source)                                       as source,
    upper(country)                                      as country
  from `funnel-analysis-473408`.`analytics`.`events`   -- the seeded CSV table
  where lower(event_name) in ('signup','profile_completed','kyc_passed','first_payment')
)
select * from raw;


[0m17:34:17.503638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:17.939613 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:14233c26-af11-44c8-8698-22c4b5a02719&page=queryresults
[0m17:34:18.002792 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:14233c26-af11-44c8-8698-22c4b5a02719&page=queryresults
[0m17:34:18.022463 [debug] [Thread-1 (]: Database Error in model stg_events (models/staging/stg_events.sql)
  Unrecognized name: step at [15:10]
  compiled code at target/run/funnel_analysis/models/staging/stg_events.sql
[0m17:34:18.024616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '465b5275-d355-4bbc-aa10-8c807938dc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1626547d0>]}
[0m17:34:18.025436 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model analytics.stg_events ...................... [[31mERROR[0m in 0.56s]
[0m17:34:18.026053 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.stg_events
[0m17:34:18.026609 [debug] [Thread-7 (]: Marking all children of 'model.funnel_analysis.stg_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_events (models/staging/stg_events.sql)
  Unrecognized name: step at [15:10]
  compiled code at target/run/funnel_analysis/models/staging/stg_events.sql.
[0m17:34:18.028126 [debug] [Thread-2 (]: Began running node model.funnel_analysis.int_user_first_step_ts
[0m17:34:18.028533 [info ] [Thread-2 (]: 2 of 6 SKIP relation analytics.int_user_first_step_ts .......................... [[33mSKIP[0m]
[0m17:34:18.028903 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.int_user_first_step_ts
[0m17:34:18.029344 [debug] [Thread-3 (]: Began running node model.funnel_analysis.int_user_funnel_path
[0m17:34:18.029748 [info ] [Thread-3 (]: 3 of 6 SKIP relation analytics.int_user_funnel_path ............................ [[33mSKIP[0m]
[0m17:34:18.030136 [debug] [Thread-3 (]: Finished running node model.funnel_analysis.int_user_funnel_path
[0m17:34:18.030651 [debug] [Thread-2 (]: Began running node model.funnel_analysis.fct_funnel_conversions
[0m17:34:18.030947 [debug] [Thread-1 (]: Began running node model.funnel_analysis.fct_funnel_by_source
[0m17:34:18.031250 [debug] [Thread-4 (]: Began running node model.funnel_analysis.fct_funnel_by_cohort
[0m17:34:18.031793 [info ] [Thread-2 (]: 6 of 6 SKIP relation analytics.fct_funnel_conversions .......................... [[33mSKIP[0m]
[0m17:34:18.032321 [info ] [Thread-1 (]: 5 of 6 SKIP relation analytics.fct_funnel_by_source ............................ [[33mSKIP[0m]
[0m17:34:18.032670 [info ] [Thread-4 (]: 4 of 6 SKIP relation analytics.fct_funnel_by_cohort ............................ [[33mSKIP[0m]
[0m17:34:18.033016 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.fct_funnel_conversions
[0m17:34:18.033312 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.fct_funnel_by_source
[0m17:34:18.033601 [debug] [Thread-4 (]: Finished running node model.funnel_analysis.fct_funnel_by_cohort
[0m17:34:18.034797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:34:18.035272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:18.035502 [debug] [MainThread]: Connection 'model.funnel_analysis.stg_events' was properly closed.
[0m17:34:18.035785 [info ] [MainThread]: 
[0m17:34:18.036002 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m17:34:18.036533 [debug] [MainThread]: Command end result
[0m17:34:18.053598 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:34:18.054914 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:34:18.059032 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m17:34:18.059221 [info ] [MainThread]: 
[0m17:34:18.059416 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:34:18.059578 [info ] [MainThread]: 
[0m17:34:18.059770 [error] [MainThread]: [31mFailure in model stg_events (models/staging/stg_events.sql)[0m
[0m17:34:18.059954 [error] [MainThread]:   Database Error in model stg_events (models/staging/stg_events.sql)
  Unrecognized name: step at [15:10]
  compiled code at target/run/funnel_analysis/models/staging/stg_events.sql
[0m17:34:18.060093 [info ] [MainThread]: 
[0m17:34:18.060260 [info ] [MainThread]:   compiled code at target/compiled/funnel_analysis/models/staging/stg_events.sql
[0m17:34:18.060393 [info ] [MainThread]: 
[0m17:34:18.060553 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 NO-OP=0 TOTAL=6
[0m17:34:18.061857 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2938297, "process_in_blocks": "0", "process_kernel_time": 0.512932, "process_mem_max_rss": "349306880", "process_out_blocks": "0", "process_user_time": 3.386759}
[0m17:34:18.062122 [debug] [MainThread]: Command `dbt run` failed at 17:34:18.062068 after 3.29 seconds
[0m17:34:18.062334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1625dd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162015db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1620163f0>]}
[0m17:34:18.062519 [debug] [MainThread]: Flushing usage events
[0m17:34:18.440538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:54.979223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf39d0>]}


============================== 17:39:54.982280 | 61bd079b-fca0-4677-a925-75bc598e89c8 ==============================
[0m17:39:54.982280 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:39:54.982602 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'empty': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'use_colors': 'True', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/barbaramariano/.dbt', 'write_json': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt seed', 'static_parser': 'True'}
[0m17:39:56.823241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61bd079b-fca0-4677-a925-75bc598e89c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee7bb0>]}
[0m17:39:56.849160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61bd079b-fca0-4677-a925-75bc598e89c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136365370>]}
[0m17:39:56.849480 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:39:57.019337 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:39:57.089363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:39:57.089655 [debug] [MainThread]: Partial parsing: updated file: funnel_analysis://seeds/events.csv
[0m17:39:57.190434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61bd079b-fca0-4677-a925-75bc598e89c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13687ae50>]}
[0m17:39:57.233722 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:39:57.235177 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:39:57.247175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61bd079b-fca0-4677-a925-75bc598e89c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1368f1c70>]}
[0m17:39:57.247421 [info ] [MainThread]: Found 6 models, 5 data tests, 1 seed, 495 macros
[0m17:39:57.247587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61bd079b-fca0-4677-a925-75bc598e89c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363cb930>]}
[0m17:39:57.248432 [info ] [MainThread]: 
[0m17:39:57.248606 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:39:57.248725 [info ] [MainThread]: 
[0m17:39:57.248951 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:39:57.249376 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m17:39:57.249567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:58.090651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m17:39:58.091508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:58.257807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61bd079b-fca0-4677-a925-75bc598e89c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a2f930>]}
[0m17:39:58.259267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:39:58.264604 [debug] [Thread-1 (]: Began running node seed.funnel_analysis.events
[0m17:39:58.265442 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.events ........................................ [RUN]
[0m17:39:58.266076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now seed.funnel_analysis.events)
[0m17:39:58.266530 [debug] [Thread-1 (]: Began compiling node seed.funnel_analysis.events
[0m17:39:58.266989 [debug] [Thread-1 (]: Began executing node seed.funnel_analysis.events
[0m17:39:58.318417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:01.046450 [debug] [Thread-1 (]: On seed.funnel_analysis.events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "seed.funnel_analysis.events"} */

    alter table `funnel-analysis-473408`.`analytics`.`events` set OPTIONS()
  
[0m17:40:01.188776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:53229cdc-80d2-4e98-9c9c-1659ff22673d&page=queryresults
[0m17:40:01.385745 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.funnel_analysis.events"
[0m17:40:01.408293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61bd079b-fca0-4677-a925-75bc598e89c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136cbab10>]}
[0m17:40:01.408873 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics.events .................................... [[32mINSERT 101[0m in 3.14s]
[0m17:40:01.409389 [debug] [Thread-1 (]: Finished running node seed.funnel_analysis.events
[0m17:40:01.410669 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:01.411146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:01.411339 [debug] [MainThread]: Connection 'seed.funnel_analysis.events' was properly closed.
[0m17:40:01.411554 [info ] [MainThread]: 
[0m17:40:01.411782 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.16 seconds (4.16s).
[0m17:40:01.412263 [debug] [MainThread]: Command end result
[0m17:40:01.431831 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:40:01.434198 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:40:01.439832 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m17:40:01.440082 [info ] [MainThread]: 
[0m17:40:01.440913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:01.441106 [info ] [MainThread]: 
[0m17:40:01.441384 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:40:01.445459 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.503373, "process_in_blocks": "0", "process_kernel_time": 0.621729, "process_mem_max_rss": "352026624", "process_out_blocks": "0", "process_user_time": 3.668012}
[0m17:40:01.446131 [debug] [MainThread]: Command `dbt seed` succeeded at 17:40:01.446054 after 6.50 seconds
[0m17:40:01.447095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a6e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136cd7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136cd7110>]}
[0m17:40:01.447410 [debug] [MainThread]: Flushing usage events
[0m17:40:01.909486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:04.183038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1f9d0>]}


============================== 17:40:04.185837 | 72b1aefd-b770-41de-94b2-dc406cce17a7 ==============================
[0m17:40:04.185837 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:40:04.186137 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/barbaramariano/.dbt', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt run', 'empty': 'False', 'partial_parse': 'True', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'fail_fast': 'False'}
[0m17:40:05.548739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72b1aefd-b770-41de-94b2-dc406cce17a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e17bb0>]}
[0m17:40:05.575767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72b1aefd-b770-41de-94b2-dc406cce17a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148165370>]}
[0m17:40:05.576107 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:40:05.739738 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:40:05.809930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:40:05.810168 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:40:05.833896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72b1aefd-b770-41de-94b2-dc406cce17a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14877a650>]}
[0m17:40:05.873260 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:40:05.874607 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:40:05.886926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72b1aefd-b770-41de-94b2-dc406cce17a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1481c3d40>]}
[0m17:40:05.887168 [info ] [MainThread]: Found 6 models, 5 data tests, 1 seed, 495 macros
[0m17:40:05.887335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72b1aefd-b770-41de-94b2-dc406cce17a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1482220b0>]}
[0m17:40:05.888240 [info ] [MainThread]: 
[0m17:40:05.888419 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:40:05.888544 [info ] [MainThread]: 
[0m17:40:05.888776 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:40:05.890673 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m17:40:05.890860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:06.596731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m17:40:06.597444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:06.735378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72b1aefd-b770-41de-94b2-dc406cce17a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14892cd50>]}
[0m17:40:06.736507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:06.744233 [debug] [Thread-1 (]: Began running node model.funnel_analysis.stg_events
[0m17:40:06.745252 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_events ............................... [RUN]
[0m17:40:06.745867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now model.funnel_analysis.stg_events)
[0m17:40:06.746298 [debug] [Thread-1 (]: Began compiling node model.funnel_analysis.stg_events
[0m17:40:06.759444 [debug] [Thread-1 (]: Writing injected SQL for node "model.funnel_analysis.stg_events"
[0m17:40:06.760328 [debug] [Thread-1 (]: Began executing node model.funnel_analysis.stg_events
[0m17:40:06.774512 [debug] [Thread-1 (]: Writing runtime sql for node "model.funnel_analysis.stg_events"
[0m17:40:06.774898 [debug] [Thread-1 (]: On model.funnel_analysis.stg_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.stg_events"} */


  create or replace view `funnel-analysis-473408`.`analytics`.`stg_events`
  OPTIONS()
  as --clean & standardize the raw seed (analytics.events) so types/text are consistent.



with raw as (
  select
    cast(user_id as int64)                              as user_id,
    timestamp(event_time)                               as event_ts,
    lower(event_name)                                   as event_name,
    cast(step as int64)                                 as step,
    lower(source)                                       as source,
    upper(country)                                      as country
  from `funnel-analysis-473408`.`analytics`.`events`   -- the seeded CSV table
  where lower(event_name) in ('signup','profile_completed','kyc_passed','first_payment')
)
select * from raw;


[0m17:40:06.775092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:07.539939 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:3f419cdb-02dd-4145-920a-a5a2e8cea0f1&page=queryresults
[0m17:40:07.741256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b1aefd-b770-41de-94b2-dc406cce17a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148b51550>]}
[0m17:40:07.741709 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_events .......................... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m17:40:07.742069 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.stg_events
[0m17:40:07.742557 [debug] [Thread-2 (]: Began running node model.funnel_analysis.int_user_first_step_ts
[0m17:40:07.742880 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.int_user_first_step_ts ................... [RUN]
[0m17:40:07.743165 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.funnel_analysis.int_user_first_step_ts'
[0m17:40:07.743352 [debug] [Thread-2 (]: Began compiling node model.funnel_analysis.int_user_first_step_ts
[0m17:40:07.744903 [debug] [Thread-2 (]: Writing injected SQL for node "model.funnel_analysis.int_user_first_step_ts"
[0m17:40:07.745437 [debug] [Thread-2 (]: Began executing node model.funnel_analysis.int_user_first_step_ts
[0m17:40:07.747102 [debug] [Thread-2 (]: Writing runtime sql for node "model.funnel_analysis.int_user_first_step_ts"
[0m17:40:07.747572 [debug] [Thread-2 (]: On model.funnel_analysis.int_user_first_step_ts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.int_user_first_step_ts"} */


  create or replace view `funnel-analysis-473408`.`analytics`.`int_user_first_step_ts`
  OPTIONS()
  as -- find the first time each user hit each funnel step



select
  user_id,
  event_name,
  min(event_ts) as first_ts
from `funnel-analysis-473408`.`analytics`.`stg_events`
group by 1,2;


[0m17:40:07.747825 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:40:08.307385 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:376d5d23-4bb4-47c9-91e7-9edca42bb006&page=queryresults
[0m17:40:08.522637 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b1aefd-b770-41de-94b2-dc406cce17a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1489e1c80>]}
[0m17:40:08.524243 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.int_user_first_step_ts .............. [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m17:40:08.525471 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.int_user_first_step_ts
[0m17:40:08.526656 [debug] [Thread-3 (]: Began running node model.funnel_analysis.int_user_funnel_path
[0m17:40:08.527379 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.int_user_funnel_path ..................... [RUN]
[0m17:40:08.528046 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.funnel_analysis.int_user_funnel_path'
[0m17:40:08.528471 [debug] [Thread-3 (]: Began compiling node model.funnel_analysis.int_user_funnel_path
[0m17:40:08.532490 [debug] [Thread-3 (]: Writing injected SQL for node "model.funnel_analysis.int_user_funnel_path"
[0m17:40:08.533851 [debug] [Thread-3 (]: Began executing node model.funnel_analysis.int_user_funnel_path
[0m17:40:08.537363 [debug] [Thread-3 (]: Writing runtime sql for node "model.funnel_analysis.int_user_funnel_path"
[0m17:40:08.538057 [debug] [Thread-3 (]: On model.funnel_analysis.int_user_funnel_path: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.int_user_funnel_path"} */


  create or replace view `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`
  OPTIONS()
  as -- reshape into one row per user with a timestamp column for each step.



with s as (select * from `funnel-analysis-473408`.`analytics`.`int_user_first_step_ts`)

select
  user_id,
  max(if(event_name='signup',            first_ts, null)) as ts_signup,
  max(if(event_name='profile_completed', first_ts, null)) as ts_profile_completed,
  max(if(event_name='kyc_passed',        first_ts, null)) as ts_kyc_passed,
  max(if(event_name='first_payment',     first_ts, null)) as ts_first_payment
from s
group by 1;


[0m17:40:08.538424 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:40:09.003621 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:bf8283a0-9122-4d93-a8e3-d62d655c9910&page=queryresults
[0m17:40:09.148803 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b1aefd-b770-41de-94b2-dc406cce17a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148ff5810>]}
[0m17:40:09.149959 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.int_user_funnel_path ................ [[32mCREATE VIEW (0 processed)[0m in 0.62s]
[0m17:40:09.150726 [debug] [Thread-3 (]: Finished running node model.funnel_analysis.int_user_funnel_path
[0m17:40:09.151729 [debug] [Thread-1 (]: Began running node model.funnel_analysis.fct_funnel_by_source
[0m17:40:09.152226 [debug] [Thread-4 (]: Began running node model.funnel_analysis.fct_funnel_by_cohort
[0m17:40:09.152735 [debug] [Thread-2 (]: Began running node model.funnel_analysis.fct_funnel_conversions
[0m17:40:09.153345 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.fct_funnel_by_source .................... [RUN]
[0m17:40:09.154043 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics.fct_funnel_by_cohort .................... [RUN]
[0m17:40:09.154616 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics.fct_funnel_conversions .................. [RUN]
[0m17:40:09.155103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.funnel_analysis.stg_events, now model.funnel_analysis.fct_funnel_by_source)
[0m17:40:09.155601 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.funnel_analysis.fct_funnel_by_cohort'
[0m17:40:09.155957 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.funnel_analysis.int_user_first_step_ts, now model.funnel_analysis.fct_funnel_conversions)
[0m17:40:09.156312 [debug] [Thread-1 (]: Began compiling node model.funnel_analysis.fct_funnel_by_source
[0m17:40:09.156642 [debug] [Thread-4 (]: Began compiling node model.funnel_analysis.fct_funnel_by_cohort
[0m17:40:09.156960 [debug] [Thread-2 (]: Began compiling node model.funnel_analysis.fct_funnel_conversions
[0m17:40:09.160521 [debug] [Thread-1 (]: Writing injected SQL for node "model.funnel_analysis.fct_funnel_by_source"
[0m17:40:09.163570 [debug] [Thread-4 (]: Writing injected SQL for node "model.funnel_analysis.fct_funnel_by_cohort"
[0m17:40:09.166674 [debug] [Thread-2 (]: Writing injected SQL for node "model.funnel_analysis.fct_funnel_conversions"
[0m17:40:09.167514 [debug] [Thread-1 (]: Began executing node model.funnel_analysis.fct_funnel_by_source
[0m17:40:09.167793 [debug] [Thread-4 (]: Began executing node model.funnel_analysis.fct_funnel_by_cohort
[0m17:40:09.168034 [debug] [Thread-2 (]: Began executing node model.funnel_analysis.fct_funnel_conversions
[0m17:40:09.176037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:09.177519 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:40:09.178708 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:09.316394 [debug] [Thread-1 (]: Writing runtime sql for node "model.funnel_analysis.fct_funnel_by_source"
[0m17:40:09.317577 [debug] [Thread-2 (]: Writing runtime sql for node "model.funnel_analysis.fct_funnel_conversions"
[0m17:40:09.318429 [debug] [Thread-4 (]: Writing runtime sql for node "model.funnel_analysis.fct_funnel_by_cohort"
[0m17:40:09.319026 [debug] [Thread-2 (]: On model.funnel_analysis.fct_funnel_conversions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.fct_funnel_conversions"} */

  
    

    create or replace table `funnel-analysis-473408`.`analytics`.`fct_funnel_conversions`
      
    
    

    
    OPTIONS()
    as (
      -- overall counts and conversion rates from step to step and end-to-end.



with path as (select * from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`)

select
  countif(ts_signup is not null)            as n_signup,
  countif(ts_profile_completed is not null) as n_profile_completed,
  countif(ts_kyc_passed is not null)        as n_kyc_passed,
  countif(ts_first_payment is not null)     as n_first_payment,

  safe_divide(countif(ts_profile_completed is not null), countif(ts_signup is not null))          as cr_signup_to_profile,
  safe_divide(countif(ts_kyc_passed is not null),        countif(ts_profile_completed is not null)) as cr_profile_to_kyc,
  safe_divide(countif(ts_first_payment is not null),     countif(ts_kyc_passed is not null))        as cr_kyc_to_payment,
  safe_divide(countif(ts_first_payment is not null),     countif(ts_signup is not null))             as cr_signup_to_payment
from path
    );
  
[0m17:40:09.320236 [debug] [Thread-1 (]: On model.funnel_analysis.fct_funnel_by_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.fct_funnel_by_source"} */

  
    

    create or replace table `funnel-analysis-473408`.`analytics`.`fct_funnel_by_source`
      
    
    

    
    OPTIONS()
    as (
      -- conversion broken down by acquisition source (e.g., ads, organic, partner).



with e as (select * from `funnel-analysis-473408`.`analytics`.`stg_events`),

firsts as (
  select user_id, min(event_ts) as signup_ts
  from e
  where event_name='signup'
  group by 1
),

source_at_signup as (
  -- source captured at the signup moment
  select f.user_id, any_value(e.source) as source
  from firsts f
  join e using (user_id)
  where e.event_name='signup' and e.event_ts = f.signup_ts
  group by f.user_id
),

path as (select * from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`),

joined as (
  select p.*, s.source
  from path p
  left join source_at_signup s using (user_id)
)

select
  source,
  countif(ts_signup is not null)            as n_signup,
  countif(ts_profile_completed is not null) as n_profile_completed,
  countif(ts_kyc_passed is not null)        as n_kyc_passed,
  countif(ts_first_payment is not null)     as n_first_payment,

  safe_divide(countif(ts_profile_completed is not null), countif(ts_signup is not null))            as cr_signup_to_profile,
  safe_divide(countif(ts_kyc_passed is not null),        countif(ts_profile_completed is not null)) as cr_profile_to_kyc,
  safe_divide(countif(ts_first_payment is not null),     countif(ts_kyc_passed is not null))        as cr_kyc_to_payment,
  safe_divide(countif(ts_first_payment is not null),     countif(ts_signup is not null))             as cr_signup_to_payment
from joined
group by source
order by source
    );
  
[0m17:40:09.320693 [debug] [Thread-4 (]: On model.funnel_analysis.fct_funnel_by_cohort: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "model.funnel_analysis.fct_funnel_by_cohort"} */

  
    

    create or replace table `funnel-analysis-473408`.`analytics`.`fct_funnel_by_cohort`
      
    
    

    
    OPTIONS()
    as (
      -- conversion by signup cohort (month of signup).



with e as (select * from `funnel-analysis-473408`.`analytics`.`stg_events`),

signup as (
  select user_id, min(event_ts) as signup_ts
  from e
  where event_name='signup'
  group by 1
),

path as (select * from `funnel-analysis-473408`.`analytics`.`int_user_funnel_path`),

joined as (
  select
    p.*,
    timestamp_trunc(s.signup_ts, month) as signup_month
  from path p
  left join signup s using (user_id)
)

select
  signup_month,
  countif(ts_signup is not null)            as n_signup,
  countif(ts_profile_completed is not null) as n_profile_completed,
  countif(ts_kyc_passed is not null)        as n_kyc_passed,
  countif(ts_first_payment is not null)     as n_first_payment
from joined
group by signup_month
order by signup_month
    );
  
[0m17:40:09.804080 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:234e8777-08ce-4b03-b42e-38522413b3a8&page=queryresults
[0m17:40:09.834220 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:48be5bbe-f87c-44a7-958b-2fc17b973c29&page=queryresults
[0m17:40:09.835920 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:1be760ed-44e2-499d-86c2-360209f3060b&page=queryresults
[0m17:40:11.340526 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b1aefd-b770-41de-94b2-dc406cce17a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148f67950>]}
[0m17:40:11.341880 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics.fct_funnel_conversions ............. [[32mCREATE TABLE (1.0 rows, 2.9 KiB processed)[0m in 2.18s]
[0m17:40:11.342729 [debug] [Thread-2 (]: Finished running node model.funnel_analysis.fct_funnel_conversions
[0m17:40:11.405796 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b1aefd-b770-41de-94b2-dc406cce17a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1490e8360>]}
[0m17:40:11.406506 [info ] [Thread-4 (]: 4 of 6 OK created sql table model analytics.fct_funnel_by_cohort ............... [[32mCREATE TABLE (1.0 rows, 2.9 KiB processed)[0m in 2.25s]
[0m17:40:11.407049 [debug] [Thread-4 (]: Finished running node model.funnel_analysis.fct_funnel_by_cohort
[0m17:40:11.652074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b1aefd-b770-41de-94b2-dc406cce17a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148fe8410>]}
[0m17:40:11.653146 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.fct_funnel_by_source ............... [[32mCREATE TABLE (3.0 rows, 3.6 KiB processed)[0m in 2.50s]
[0m17:40:11.653900 [debug] [Thread-1 (]: Finished running node model.funnel_analysis.fct_funnel_by_source
[0m17:40:11.656235 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:11.657148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:11.657496 [debug] [MainThread]: Connection 'model.funnel_analysis.fct_funnel_by_source' was properly closed.
[0m17:40:11.657775 [debug] [MainThread]: Connection 'model.funnel_analysis.fct_funnel_conversions' was properly closed.
[0m17:40:11.658013 [debug] [MainThread]: Connection 'model.funnel_analysis.int_user_funnel_path' was properly closed.
[0m17:40:11.658245 [debug] [MainThread]: Connection 'model.funnel_analysis.fct_funnel_by_cohort' was properly closed.
[0m17:40:11.658729 [info ] [MainThread]: 
[0m17:40:11.659064 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m17:40:11.660769 [debug] [MainThread]: Command end result
[0m17:40:11.686613 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m17:40:11.688715 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m17:40:11.693316 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m17:40:11.693525 [info ] [MainThread]: 
[0m17:40:11.693749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:11.693920 [info ] [MainThread]: 
[0m17:40:11.694115 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m17:40:11.697236 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.5469866, "process_in_blocks": "0", "process_kernel_time": 0.667388, "process_mem_max_rss": "350224384", "process_out_blocks": "0", "process_user_time": 3.595892}
[0m17:40:11.697625 [debug] [MainThread]: Command `dbt run` succeeded at 17:40:11.697560 after 7.55 seconds
[0m17:40:11.697902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149138a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1491386b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14913bf50>]}
[0m17:40:11.698169 [debug] [MainThread]: Flushing usage events
[0m17:40:12.167066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:19.350616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141841a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115663890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156639d0>]}


============================== 18:12:19.354124 | 49983ed6-5f2e-4ac0-8cbe-704cb712c800 ==============================
[0m18:12:19.354124 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:12:19.354435 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'debug': 'False', 'quiet': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/barbaramariano/.dbt', 'invocation_command': 'dbt seed --select events', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'version_check': 'True', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'warn_error': 'None', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'empty': 'None', 'log_path': '/Users/barbaramariano/repositories/funnel_analysis/logs', 'indirect_selection': 'eager'}
[0m18:12:21.424530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49983ed6-5f2e-4ac0-8cbe-704cb712c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142c7bb0>]}
[0m18:12:21.450949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49983ed6-5f2e-4ac0-8cbe-704cb712c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161f65370>]}
[0m18:12:21.451275 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:12:21.666637 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:12:21.739165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:21.739377 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:21.760795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49983ed6-5f2e-4ac0-8cbe-704cb712c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16247e650>]}
[0m18:12:21.799174 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m18:12:21.801353 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m18:12:21.815564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49983ed6-5f2e-4ac0-8cbe-704cb712c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1624f5d60>]}
[0m18:12:21.815811 [info ] [MainThread]: Found 6 models, 5 data tests, 1 seed, 495 macros
[0m18:12:21.815970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49983ed6-5f2e-4ac0-8cbe-704cb712c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1620220b0>]}
[0m18:12:21.816777 [info ] [MainThread]: 
[0m18:12:21.816953 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m18:12:21.817070 [info ] [MainThread]: 
[0m18:12:21.817294 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:12:21.817693 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_funnel-analysis-473408'
[0m18:12:21.817889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:23.330255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408, now list_funnel-analysis-473408_analytics)
[0m18:12:23.331115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:23.476588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49983ed6-5f2e-4ac0-8cbe-704cb712c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162728d50>]}
[0m18:12:23.477215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:23.480824 [debug] [Thread-1 (]: Began running node seed.funnel_analysis.events
[0m18:12:23.481376 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.events ........................................ [RUN]
[0m18:12:23.481798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_funnel-analysis-473408_analytics, now seed.funnel_analysis.events)
[0m18:12:23.482119 [debug] [Thread-1 (]: Began compiling node seed.funnel_analysis.events
[0m18:12:23.482413 [debug] [Thread-1 (]: Began executing node seed.funnel_analysis.events
[0m18:12:23.529514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:25.763738 [debug] [Thread-1 (]: On seed.funnel_analysis.events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "funnel_analysis", "target_name": "prod", "node_id": "seed.funnel_analysis.events"} */

    alter table `funnel-analysis-473408`.`analytics`.`events` set OPTIONS()
  
[0m18:12:25.931524 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=funnel-analysis-473408&j=bq:europe-west9:ac4dc61e-8f22-4bf4-a3ca-9aecd63a1936&page=queryresults
[0m18:12:26.108682 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.funnel_analysis.events"
[0m18:12:26.131777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49983ed6-5f2e-4ac0-8cbe-704cb712c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162cc2210>]}
[0m18:12:26.132341 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics.events .................................... [[32mINSERT 101[0m in 2.65s]
[0m18:12:26.132802 [debug] [Thread-1 (]: Finished running node seed.funnel_analysis.events
[0m18:12:26.133991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:26.134600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:26.134837 [debug] [MainThread]: Connection 'seed.funnel_analysis.events' was properly closed.
[0m18:12:26.135090 [info ] [MainThread]: 
[0m18:12:26.135334 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m18:12:26.135859 [debug] [MainThread]: Command end result
[0m18:12:26.153661 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/barbaramariano/repositories/funnel_analysis/target/manifest.json
[0m18:12:26.156151 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/barbaramariano/repositories/funnel_analysis/target/semantic_manifest.json
[0m18:12:26.159978 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/barbaramariano/repositories/funnel_analysis/target/run_results.json
[0m18:12:26.160192 [info ] [MainThread]: 
[0m18:12:26.160666 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:26.160850 [info ] [MainThread]: 
[0m18:12:26.161055 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:12:26.164184 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.8594923, "process_in_blocks": "0", "process_kernel_time": 0.720065, "process_mem_max_rss": "347078656", "process_out_blocks": "0", "process_user_time": 3.533434}
[0m18:12:26.164596 [debug] [MainThread]: Command `dbt seed` succeeded at 18:12:26.164539 after 6.86 seconds
[0m18:12:26.164864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1627ede90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162d8b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162d8b250>]}
[0m18:12:26.165077 [debug] [MainThread]: Flushing usage events
[0m18:12:26.628565 [debug] [MainThread]: An error was encountered while trying to flush usage events
